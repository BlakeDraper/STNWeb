<!-- Site title with number-->
<div class="col-md-12">
    <div ui-view="siteNo"></div>
</div>

<!-- Site with map above it -->
<div class="col-md-8">
    <div ui-view="aSite"></div>
</div>

<!-- if there's a site, show the OP, Sensor, HWM, Files, and Peaks -->
<div ng-if="siteID > 0">
    <div class="col-md-4">
        <div ui-view="op"></div>
        <div ui-view="sensor"></div>
        <div ui-view="hwm"></div>
        <div ui-view="file"></div>
        <div ui-view="peak"></div>
    </div>
</div>

<!-- Style for 'graying' out proposed sensor parts -->
<style type="text/css">
    .darkClass {
        filter: alpha(opacity=50); /* IE */
        opacity: 0.5; /* Safari, Opera */
        -moz-opacity: 0.50; /* FireFox */
        z-index: 20;
        background-repeat: no-repeat;
        background-position: center;
    }
</style>

<!-- MODAL for Site Create/edit-->
<script type="text/ng-template" id="SITEmodal.html">
    <div class="modal-header">
        <h3 class="modal-title">Site<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>
    <form class="form-horizontal" name="siteForm">
        <fieldset>
            <div class="modal-body">

                <!--<legend>Site Information</legend>-->
                <!--Site Description*-->
                <div class="form-group required">
                    <label class="col-md-4 control-label req" for="SITE_DESCRIPTION">Site Description:</label>
                    <div class="col-md-7">
                        <textarea class="form-control" id="SITE_DESCRIPTION" type="text" rows="3" placeholder="Site Description" ng-model="aSite.SITE_DESCRIPTION" required />
                    </div>
                </div>

                <!--Internal Notes-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="SITE_NOTES">Internal Notes:</label>
                    <div class="col-md-7">
                        <textarea class="form-control" id="SITE_NOTES" type="text" rows="3" placeholder="Internal Notes" ng-model="aSite.SITE_NOTES" />
                    </div>
                </div>

                <!-- dec deg or dms: -->
                <div class="form-group">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-7">
                        <label class="radio-inline">
                            <input type="radio" name="decDegORdms" ng-model="aSite.decDegORdms" ng-change="latLongChange()" value="dd" /> Dec Deg
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="decDegORdms" ng-model="aSite.decDegORdms" ng-change="latLongChange()" value="dms" /> DMS
                        </label>
                    </div>
                </div>

                <!--Latitude*-->
                <div class="form-group required" ng-class="{'has-error':siteForm.LATITUDE_DD.$invalid && siteForm.LATITUDE_DD.$dirty}">
                    <label class="col-md-4 control-label req" for="LATITUDE_DD">Latitude:</label>
                    <div class="col-md-7" ng-if="aSite.decDegORdms == 'dd'">
                        <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="aSite.LATITUDE_DD"
                               ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue()" type="text" placeholder="Latitude" required />
                    </div>
                    <div class="col-md-7" ng-if="aSite.decDegORdms == 'dms'">
                        <table>
                            <tr>
                                <td><input class="form-control" ng-keypress="isNum($event)" ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue('dms')" id="LaDeg" name="Deg" ng-model="DMS.LADeg" type="text" /></td>
                                <td>°</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Min" ng-model="DMS.LAMin" type="text" /></td>
                                <td>′</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Sec" ng-model="DMS.LASec" type="text" /></td>
                                <td>″</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!--Longitude*-->
                <div class="form-group required" ng-class="{'has-error':siteForm.LONGITUDE_DD.$invalid && siteForm.LONGITUDE_DD.$dirty}">
                    <label class="col-md-4 control-label req" for="LONGITUDE_DD">Longitude:</label>
                    <div class="col-md-7" ng-if="aSite.decDegORdms == 'dd'">
                        <input class="form-control" ng-keypress="isNum($event)" ng-enter="getAddress()" id="LONGITUDE_DD" name="LONGITUDE_DD" ng-model="aSite.LONGITUDE_DD"
                               ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue()" type="text" placeholder="Longitude" required />
                    </div>
                    <div class="col-md-7" ng-if="aSite.decDegORdms == 'dms'">
                        <table>
                            <tr>
                                <td><input class="form-control" ng-keypress="isNum($event)" ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue('dms')" id="LoDeg" name="Deg" ng-model="DMS.LODeg" type="text" /></td>
                                <td>°</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Min" ng-model="DMS.LOMin" type="text" /></td>
                                <td>′</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Sec" ng-model="DMS.LOSec" type="text" /></td>
                                <td>″</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!--populate button*-->
                <div class="form-group required" ng-if="aSite.SITE_ID == undefined">
                    <label class="col-md-4 control-label" for="POPULATEBTN">Click here to populate address fields:</label>
                    <div class="col-md-7">
                        <button type="button" ng-click="getAddress()" class="btn btn-primary">Verify Location</button>
                    </div>
                </div>

                <!-- map showing lat/long location-->
                <div class="col-md-7 col-md-offset-3" style="height:300px;display:table;" ng-show="showMap">
                    <div><label>There are: {{closeSites.length}} sites nearby.</label></div>
                    <p ng-if="closeSites.length > 0">
                        <span>To use one of these sites (shown as blue dot) instead, click on the site name.</span>
                        <ul style="max-height:50px;overflow:auto;">
                            <li ng-repeat="s in closeSites" style="list-style:none">
                                <a ui-sref="site.dashboard({id: s.SITE_ID})" ng-click="$dismiss()">{{s.SITE_NO}}</a>
                            </li>
                        </ul>
                    </p>
                    <div class="panel panel-primary" style="height:inherit">
                        <leaflet lf-center="mapCenter" width="100%" height="100%" markers="mapMarkers"></leaflet>
                    </div>
                </div>
                <br clear="all" />
                <!--Horizontal Datum*-->
                <div class="form-group required" ng-class="{'has-error':siteForm.HDATUM_ID.$invalid && siteForm.HDATUM_ID.$dirty}">
                    <label class="col-md-4 control-label req" for="HDATUM_ID">Horizontal Datum:</label>
                    <div class="col-md-7">
                        <select class="form-control" name="HDATUM_ID" ng-model="aSite.HDATUM_ID"
                                ng-options="hd.DATUM_ID as hd.DATUM_NAME for hd in HorizontalDatumList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!--Horizontal Collection Method*-->
                <div class="form-group required" ng-class="{'has-error':siteForm.HCOLLECT_METHOD_ID.$invalid && siteForm.HCOLLECT_METHOD_ID.$dirty}">
                    <label class="col-md-4 control-label req" for="HCOLLECT_METHOD_ID">Horizontal Collection Method:</label>
                    <div class="col-md-7">
                        <select class="form-control" name="HCOLLECT_METHOD_ID" ng-model="aSite.HCOLLECT_METHOD_ID"
                                ng-options="hc.HCOLLECT_METHOD_ID as hc.HCOLLECT_METHOD for hc in HorCollMethodList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!--Address-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="ADDRESS">Address:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="ADDRESS" ng-model="aSite.ADDRESS" type="text" />
                    </div>
                </div>

                <!--City-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="CITY">City:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="CITY" ng-model="aSite.CITY" type="text" />
                    </div>
                </div>

                <!--State*-->
                <div class="form-group required" ng-class="{'has-error':siteForm.STATE.$invalid && siteForm.STATE.$dirty}">
                    <label class="col-md-4 control-label req" for="STATE">State:</label>
                    <div class="col-md-7">
                        <select class="form-control" name="STATE" ng-model="aSite.STATE" ng-change="updateCountyList(aSite.STATE)"
                                ng-options="state.STATE_ABBREV as state.STATE_NAME for state in StateList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!--Zip-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="ZIP">Zip:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="ZIP" ng-model="aSite.ZIP" type="text" ui-mask="{{'99999'}}" />
                    </div>
                </div>

                <!--County*-->
                <div class="form-group required" ng-class="{'has-error':siteForm.COUNTY.$invalid && siteForm.COUNTY.$dirty}">
                    <label class="col-md-4 control-label req" for="COUNTY">County:</label>
                    <div class="col-md-7">
                        <select class="form-control" name="COUNTY" ng-model="aSite.COUNTY" ng-options="c.COUNTY_NAME as c.COUNTY_NAME for c in stateCountyList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!--Waterbody*-->
                <div class="form-group required" ng-class="{'has-error':siteForm.WATERBODY.$invalid && siteForm.WATERBODY.$dirty}">
                    <label class="col-md-4 control-label req" for="WATERBODY">Waterbody:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="WATERBODY" ng-model="aSite.WATERBODY" type="text" required />
                    </div>
                </div>

                <!--Drainage Area-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="DRAINAGE_AREA_SQMI">Drainage Area (sq mi):</label>
                    <div class="col-md-7">
                        <input class="form-control" name="DRAINAGE_AREA_SQMI" ng-model="aSite.DRAINAGE_AREA_SQMI" type="text" />
                    </div>
                </div>

                <!--Station ID for USGS gage-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="USGS_SID">Station ID for USGS gage:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="USGS_SID" ng-model="aSite.USGS_SID" type="text" />
                    </div>
                </div>

                <!--Station ID for NOAA gage-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="NOAA_SID">Station ID for NOAA gage:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="NOAA_SID" ng-model="aSite.NOAA_SID" type="text" />
                    </div>
                </div>

                <!--Other Station ID-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="OTHER_SID">Other Station ID:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="OTHER_SID" placeholder="Please add details in the Site Description" ng-model="aSite.OTHER_SID" type="text" />
                    </div>
                </div>

                <!--Safety Notes-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="SAFETY_NOTES">Safety Notes:</label>
                    <div class="col-md-7">
                        <textarea class="form-control" type="text" rows="3" ng-model="aSite.SAFETY_NOTES" />
                    </div>
                </div>

                <hr />

                <!--Site Housing section-->
                <div class="form-group">
                    <div style="padding:0" class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Site Housing</h3>
                        </div>
                        <div class="panel-body">
                            <label class="col-md-4 control-label" for="HOUSING_TYPE">Site Housing(s):</label>
                            <div class="col-md-7">
                                <div isteven-multi-select
                                     input-model="allHousingTypeList"
                                     output-model="houseType.value"
                                     button-label="TYPE_NAME"
                                     item-label="TYPE_NAME"
                                     max-height="300px"
                                     on-item-click="HouseTypeClick(data)"
                                     tick-property="selected"
                                     helper-elements="filter">
                                </div>
                            </div>
                            <br clear="all" />
                            <div ng-show="siteHouseTypesTable.length > 0">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th class="col-sm-3">House Type</th>
                                            <th class="col-sm-1">Housing Length (ft)</th>
                                            <th class="col-sm-3">Housing Material</th>
                                            <th class="col-sm-3">Housing Notes</th>
                                            <th class="col-sm-1">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="house in siteHouseTypesTable">
                                            <td>{{house.TYPE_NAME}}<input type="hidden" ng-model="house.HOUSING_TYPE_ID" /><input type="hidden" ng-model="house.SITE_HOUSING_ID" /></td>
                                            <td><input style="width:70%" ng-keypress="isNum($event)" ng-model="house.LENGTH" /></td>
                                            <td><input ng-model="house.MATERIAL" /></td>
                                            <td><input ng-model="house.NOTES" /></td>
                                            <td><input style="width:70%" ng-keypress="isNum($event)" ng-model="house.AMOUNT" /></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div><!-- end panel-body-->
                    </div>
                </div>

                <!--Priority-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="PRIORITY_ID">Priority:</label>
                    <div class="col-md-7">
                        <select class="form-control" name="PRIORITY_ID" ng-model="aSite.PRIORITY_ID" ng-options="p.PRIORITY_ID as p.PRIORITY_NAME for p in DepPriorityList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!--Network Type-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="NETWORK_TYPE">Site Location Type in the Network:</label>
                    <div class="col-md-7">
                        <ul style="padding-left:0">
                            <li style="list-style:none;" ng-repeat="nt in NetTypeList">
                                <input type="checkbox" ng-model="nt.selected" ng-change="netTypeChg()" />
                                <span>{{nt.NETWORK_TYPE_NAME}}</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!--Network NAME-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="NETWORK_NAME">Network Name:</label>
                    <div class="col-md-7">
                        <ul style="padding-left:0">
                            <li style="list-style:none;" ng-repeat="nn in NetNameList">
                                <input type="checkbox" ng-model="nn.selected" ng-change="whichOne(nn)" ng-disabled="(checked == checkedName) && (nn.NAME != checkedName)" />
                                <span>{{nn.NAME}}</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!--Zone-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="ZONE">Zone:</label>
                    <div class="col-md-7">
                        <input class="form-control" name="ZONE" ng-model="aSite.ZONE" type="text" />
                    </div>
                </div>

                <!--Sensor Not Appropriate-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="SENSOR_NOT_APPROPRIATE">Check if Sensor is not appropriate here:</label>
                    <div class="col-md-7">
                        <ul style="padding-left:0">
                            <li style="list-style:none;">
                                <input type="checkbox" name="SENSOR_NOT_APPROPRIATE" ng-click="dimAction()" ng-model="aSite.SENSOR_NOT_APPROPRIATE" ng-true-value="1" ng-false-value="0" />
                            </li>
                        </ul>
                    </div>
                </div>

                <!--Permanent Sensor Housing?-->
                <div class="form-group sensorInfo" ng-class="{darkClass:disableSensorParts}">
                    <label class="col-md-4 control-label" for="IS_PERMANENT_HOUSING_INSTALLED">Permanent Sensor Housing Installed?</label>
                    <div class="col-md-7">
                        <label class="radio-inline">
                            <input ng-disabled="disableSensorParts" type="radio" name="IS_PERMANENT_HOUSING_INSTALLED" ng-model="aSite.IS_PERMANENT_HOUSING_INSTALLED" value="Yes"> Yes
                        </label>
                        <label class="radio-inline">
                            <input ng-disabled="disableSensorParts" type="radio" name="IS_PERMANENT_HOUSING_INSTALLED" ng-model="aSite.IS_PERMANENT_HOUSING_INSTALLED" value="No"> No
                        </label>
                    </div>
                </div>

                <!--Add Proposed Sensor-->
                <div class="form-group sensorInfo" ng-class="{darkClass:disableSensorParts}" ng-show="aSite.SITE_ID == undefined">
                    <label class="col-md-4 control-label" for="PROPOSED_SENSOR">Add Proposed Sensor:</label>
                    <div class="col-md-7">
                        <ul style="padding-left:0">
                            <li style="list-style:none;" ng-repeat="ps in ProposedSens">
                                <input ng-disabled="disableSensorParts" type="checkbox" ng-model="ps.selected" ng-value="{{ps.selected}}" />
                                <span>{{ps.METHOD}}</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!--Site creator-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="MEMBER_ID">Site Creator:</label>
                    <div class="col-md-7">
                        <span>{{aSite.Creator}}</span>
                    </div>
                </div>

                <!--Add Landowner button-->
                <div class="form-group" ng-show="aSite.LANDOWNERCONTACT_ID == null">
                    <label class="col-md-4 control-label" for="LANDOWNERBTN">Landowner Contact:</label>
                    <div class="col-md-7">
                        <button type="button" ng-click="showLandOwnerPart()" class="btn btn-primary">Add Landowner</button>
                        <!-- <button type="button" ng-click="collapseLandowner = !collapseLandowner" class="btn btn-primary">Add Landowner</button>-->
                    </div>
                </div>

                <!--start Landowner contact area -->


                <div ng-show="addLandowner">
                    <div class="col-md-9 col-md-offset-1" style="border:solid 1px red">Do not record information that private citizens have a reasonable expectation of privacy about. No names or phone numbers of private citizens. Business contact information is acceptable.</div>
                    <div class="panel panel-default col-md-9 col-md-offset-1" style="padding:0">
                        <div class="panel-heading">Land Owner Information</div>
                        <div class="panel-body">
                            <!--First Name:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="FNAME">First Name:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOFNAME" name="FNAME" ng-model="landowner.FNAME" type="text" />
                                </div>
                            </div>
                            <!--Last Name:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="LNAME">Last Name:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOLNAME" name="LNAME" ng-model="landowner.LNAME" type="text" />
                                </div>
                            </div>
                            <!--Affiliation/Title:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="TITLE">Affiliation/Title:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOTITLE" name="TITLE" ng-model="landowner.TITLE" type="text" />
                                </div>
                            </div>
                            <!--Address:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="ADDRESS">Address:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOADDRESS" name="ADDRESS" ng-model="landowner.ADDRESS" type="text" />
                                </div>
                            </div>
                            <!--City:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="CITY">City:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOCITY" name="CITY" ng-model="landowner.CITY" type="text" />
                                </div>
                            </div>
                            <!--State-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="STATE">State:</label>
                                <div class="col-md-7">
                                    <select class="form-control" id="LOSTATE" name="STATE" ng-model="landowner.STATE" ng-options="state.STATE_ABBREV as state.STATE_NAME for state in StateList">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                            <!--Zip:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="ZIP">Zip:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOZIP" name="ZIP" ng-model="landowner.ZIP" type="text" ui-mask="{{'99999'}}" />
                                </div>
                            </div>
                            <!--Primary Phone:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="PRIMARYPHONE">Primary Phone:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOPRIMARYPHONE" name="PRIMARYPHONE"
                                           type="text" my-input-mask="{mask: '(999) 999-9999[ x99999]', greedy: false}"
                                           ng-model="landowner.PRIMARYPHONE" />
                                </div>
                            </div>
                            <!--Secondary Phone:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="SECONDARYPHONE">Secondary Phone:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOSECONDARYPHONE" name="SECONDARYPHONE"
                                           type="text" my-input-mask="{mask: '(999) 999-9999[ x99999]', greedy:false}"
                                           ng-model="landowner.SECONDARYPHONE" />
                                </div>
                            </div>
                            <!--Email:-->
                            <div class="form-group">
                                <label class="col-md-4 control-label" for="EMAIL">Email:</label>
                                <div class="col-md-7">
                                    <input class="form-control" id="LOEMAIL" name="EMAIL" ng-model="landowner.EMAIL" type="email" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br clear="all" />
                <!--end Landowner contact area-->
                <!--Access Permission Granted-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="ACCESS_GRANTED">Access Permission Granted:</label>
                    <div class="col-md-7">
                        <label class="radio-inline">
                            <input type="radio" name="ACCESS_GRANTED" ng-model="aSite.ACCESS_GRANTED" value="Yes"> Yes
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="ACCESS_GRANTED" ng-model="aSite.ACCESS_GRANTED" value="No"> No
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="ACCESS_GRANTED" ng-model="aSite.ACCESS_GRANTED" value="Not Needed"> Not Needed
                        </label>
                    </div>
                </div>

                <br clear="all" />

                <!--submit and cancel buttons-->
                <div class="form-group">
                    <div class="col-md-4 col-md-offset-2">
                        <span>
                            <button ng-show="aSite.SITE_ID == undefined" class="btn btn-primary" style="width:80px;margin-right:10px" ng-click="create(siteForm.$valid)">
                                <span>Create</span>
                            </button>
                        </span>
                        <span>
                            <button ng-show="aSite.SITE_ID != undefined" class="btn btn-primary" style="width:80px;margin-right:10px" ng-click="save(siteForm.$valid)">
                                <span>Save</span>
                            </button>
                        </span>
                        <span ng-if="userRole == 'Admin'">
                            <button ng-show="aSite.SITE_ID != undefined" class="btn btn-danger" style="width:80px;margin-right:10px" ng-click="deleteSite()">
                                <span>Delete</span>
                            </button>
                        </span>
                        <span>
                            <button type="button" class="btn btn-default" ng-click="cancel()">
                                <span>Cancel</span>
                            </button>
                        </span>
                    </div>
                </div>
            </div><!--end modal-body -->
        </fieldset>
    </form>
</script>

<!-- MODAL for Objective Point -->
<script type="text/ng-template" id="OPmodal.html">

    <div class="modal-header">
        <h3 class="modal-title">Datum Location<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>

    <div class="modal-body">
        <form class="form-horizontal" name="OPForm">
            <fieldset>
                <!-- Type: -->
                <div class="form-group required" ng-class="{'has-error':OPForm.OP_TYPE_ID.$invalid && OPForm.OP_TYPE_ID.$dirty}">
                    <label class="col-md-4 control-label req" for="OP_TYPE_ID">Type:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="OP_TYPE_ID" ng-model="OP.OP_TYPE_ID"
                                ng-options="opt.OBJECTIVE_POINT_TYPE_ID as opt.OP_TYPE for opt in OPTypeList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Name: -->
                <div class="form-group required" ng-class="{'has-error':OPForm.NAME.$invalid && OPForm.NAME.$dirty}">
                    <label class="col-md-4 control-label req" for="NAME">Name:</label>
                    <div class="col-md-6">
                        <input class="form-control" name="NAME" ng-model="OP.NAME" type="text" required />
                    </div>
                </div>

                <!-- Description: -->
                <div class="form-group required" ng-class="{'has-error':OPForm.DESCRIPTION.$invalid && OPForm.DESCRIPTION.$dirty}">
                    <label class="col-md-4 control-label req" for="DESCRIPTION">Description:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" name="DESCRIPTION" type=" text" rows="3" ng-model="OP.DESCRIPTION" required />
                    </div>
                </div>

                <!-- Control Identifier add button -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="CONTROL">Control Identifier:</label>
                    <div class="col-md-6">
                        <button type="button" class="btn btn-default" ng-click="addNewIdentifier()">Add New Identifier</button>
                    </div>
                </div>

                <!-- Control Identifier input: -->
                <div class="form-group" ng-show="showControlIDinput">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-6">
                        <div ng-repeat="id in addedIdentifiers">
                            <div class="col-md-12" style="margin-bottom:5px">
                                <div class="col-md-7"><input class="form-control" name="OPControl" ng-model="id.IDENTIFIER" type="text" /></div>
                                <input type="hidden" name="OP_CONTROL_IDENTIFIER_ID" ng-model="id.OP_CONTROL_IDENTIFIER_ID" />
                                <input type="hidden" name="OBJECTIVE_POINT_ID" ng-model="id.OBJECTIVE_POINT_ID" />

                                <label class="radio-inline">
                                    <input type="radio" name="IDENTIFIER_TYPE{{$index}}" ng-model="id.IDENTIFIER_TYPE" value="PID" /> PID
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="IDENTIFIER_TYPE{{$index}}" ng-model="id.IDENTIFIER_TYPE" value="Other" /> Other
                                </label>
                                <div class="buttons pull-right">
                                    <button class="btn" ng-click="RemoveID(id)">
                                        <i class="glyphicon glyphicon-remove"></i>
                                    </button>
                                </div>
                            </div><br />
                        </div>
                    </div>
                </div>

                <!-- dec deg or dms: -->
                <div class="form-group" style="margin-bottom: 0;padding-bottom: 0">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="decDegORdms" ng-change="latLongChange()" ng-model="OP.decDegORdms" value="dd" /> Dec Deg
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="decDegORdms" ng-change="latLongChange()" ng-model="OP.decDegORdms" value="dms" /> DMS
                        </label>
                    </div>
                </div>

                <!-- Latitude: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="LATITUDE_DD">Latitude:</label>
                    <div class="col-md-6" ng-if="OP.decDegORdms == 'dd'">
                        <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="OP.LATITUDE_DD"
                               ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue()" type="text" />
                    </div>
                    <div class="col-md-6" ng-if="OP.decDegORdms == 'dms'">
                        <table>
                            <tr>
                                <td><input class="form-control" ng-keypress="isNum($event)" ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue('dms')" id="LaDeg" name="Deg" ng-model="DMS.LADeg" type="text" /></td>
                                <td>°</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Min" ng-model="DMS.LAMin" type="text" /></td>
                                <td>′</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Sec" ng-model="DMS.LASec" type="text" /></td>
                                <td>″</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Longitude: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="LONGITUDE_DD">Longitude:</label>
                    <div class="col-md-6" ng-if="OP.decDegORdms == 'dd'">
                        <input class="form-control" ng-keypress="isNum($event)" id="LONGITUDE_DD" name="LONGITUDE_DD" ng-model="OP.LONGITUDE_DD"
                               ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue()" type="text" />
                    </div>
                    <div class="col-md-6" ng-if="OP.decDegORdms == 'dms'">
                        <table>
                            <tr>
                                <td><input class="form-control" ng-keypress="isNum($event)" ng-model-options="{ updateOn: 'blur' }" ng-change="checkValue('dms')" id="LoDeg" name="Deg" ng-model="DMS.LODeg" type="text" /></td>
                                <td>°</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Min" ng-model="DMS.LOMin" type="text" /></td>
                                <td>′</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Sec" ng-model="DMS.LOSec" type="text" /></td>
                                <td>″</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Horizontal Datum: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="HDATUM_ID">Horizontal Datum:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="HDATUM_ID" ng-model="OP.HDATUM_ID"
                                ng-options="hd.DATUM_ID as hd.DATUM_NAME for hd in HDList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Horizontal Collection Method: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="HCOLLECT_METHOD_ID">Horizontal Collection Method:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="HCOLLECT_METHOD_ID" ng-model="OP.HCOLLECT_METHOD_ID"
                                ng-options="hcm.HCOLLECT_METHOD_ID as hcm.HCOLLECT_METHOD for hcm in HCollectMethodList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Ft or Meter radios: -->
                <div class="form-group" style="margin-bottom: 0;padding-bottom: 0">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="FTorMETER" ng-model="OP.FTorMETER" value="ft" /> ft
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="FTorMETER" ng-model="OP.FTorMETER" value="meter" /> meter
                        </label>
                    </div>
                </div>

                <!-- Elevation: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="ELEV_FT">Elevation:</label>
                    <div class="col-md-6">
                        <input class="form-control" ng-keypress="isNum($event)" name="ELEV_FT" ng-model="OP.ELEV_FT" type="text" />
                    </div>
                </div>

                <!-- Vertical Datum: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="VDATUM_ID">Vertical Datum:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="VDATUM_ID" ng-model="OP.VDATUM_ID"
                                ng-options="vd.DATUM_ID as vd.DATUM_ABBREVIATION for vd in VDatumList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Vertical Collection Method: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="VCOLLECT_METHOD_ID">Vertical Collection Method:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="VCOLLECT_METHOD_ID" ng-model="OP.VCOLLECT_METHOD_ID"
                                ng-options="vcm.VCOLLECT_METHOD_ID as vcm.VCOLLECT_METHOD for vcm in VCollectMethodList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Ft or CM radios: -->
                <div class="form-group" style="margin-bottom: 0;padding-bottom: 0">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="FTorCM" ng-model="OP.FTorCM" value="ft" /> +/- ft
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="FTorCM" ng-model="OP.FTorCM" value="cm" /> +/- cm
                        </label>
                    </div>
                </div>

                <!-- Uncertainty: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="UNCERTAINTY">Uncertainty:</label>
                    <div class="col-md-6">
                        <div class="col-md-12" style="margin-bottom:5px;padding-left:0">
                            <div class="col-md-3" style="padding-left: 0;"><input class="form-control" ng-disabled="OP.UNQUANTIFIED==1" ng-keypress="isNum($event)" ng-model="OP.UNCERTAINTY" type="text" /></div>
                            <div class="col-md-2" style="text-decoration:underline">OR</span></div>
                            <div class="col-md-5">
                                <input type="checkbox" ng-model="OP.UNQUANTIFIED" ng-checked="OP.UNQUANTIFIED==1" ng-true-value="1" ng-false-value="0" ng-click="UnquantChecked()" />
                                <span style="margin-left:10px">Unquantified</span>
                            </div>
                            <br />
                        </div>
                    </div>
                </div>

                <!-- Quality: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="OP_QUALITY_ID">Quality:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="OP_QUALITY_ID" ng-model="OP.OP_QUALITY_ID"
                                ng-options="opq.OP_QUALITY_ID as opq.QUALITY for opq in OPQualityList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Objective Point Notes: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="OP_NOTES">Datum Location Notes:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" type="text" rows="3" ng-model="OP.OP_NOTES" />
                    </div>
                </div>

                <!-- Date Established: -->
                <div class="form-group required" ng-class="{'has-error':OPForm.DATE_ESTABLISHED.$invalid && OPForm.DATE_ESTABLISHED.$dirty}">
                    <label class="col-md-4 control-label req" for="DATE_ESTABLISHED">Date Established:</label>
                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                        <input class="form-control" name="de" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                               is-open="datepickrs.de" ng-model="OP.DATE_ESTABLISHED" required />
                        <span class="input-group-btn">
                            <button class="btn btn-default" ng-click="open($event, 'de')">
                                <i class="glyphicon glyphicon-calendar" />
                            </button>
                        </span>
                    </div>
                </div>

                <!-- Date Recovered: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="DATE_RECOVERED">Date Recovered:</label>
                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                        <input disabled="disabled" show-weeks="false" class="form-control" name="dr" type="text" uib-datepicker-popup="MMM dd, yyyy"
                               is-open="datepickrs.dr" ng-model="OP.DATE_RECOVERED" />
                        <span class="input-group-btn">
                            <button class="btn btn-default" ng-click="open($event, 'dr')">
                                <i class="glyphicon glyphicon-calendar" />
                            </button>
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-12">
                        <span>
                            <button ng-show="OP.OBJECTIVE_POINT_ID == undefined" class="btn btn-primary" ng-click="create(OPForm.$valid)">
                                <span>Create</span>
                            </button>
                        </span>
                        <span>
                            <button ng-show="OP.OBJECTIVE_POINT_ID != undefined" ng-disabled="showFileForm" class="btn btn-primary" ng-click="save(OPForm.$valid)">
                                <span>Save</span>
                            </button>
                        </span>
                        <span>
                            <button ng-show="OP.OBJECTIVE_POINT_ID != undefined" ng-disabled="showFileForm" class="btn btn-danger" ng-click="deleteOP(OPForm.$valid)">
                                <span>Delete</span>
                            </button>
                        </span>
                        <span>
                            <button type="button" class="btn btn-warning" ng-disabled="showFileForm" ng-click="cancel()">
                                <span>Cancel/Close</span>
                            </button>
                        </span>
                    </div>
                </div>
            </fieldset>
        </form>

        <!-- OBJECTIVE POINT FILES SECTION -->
        <div ng-if="OP.OBJECTIVE_POINT_ID !== undefinfed" class="col-md-12">


            <div class="col-md-4"><h3>Datum Location Files</h3></div>
            <div class="col-md-6" ng-if="!showFileForm" style="margin-top:14px">
                <button type="button" class="borderLess" ng-click="showFile(0)" tooltip-placement="right" uib-tooltip="Upload a new File to this OP">
                    <span class="glyphicon glyphicon-plus"></span>
                </button>
            </div>
            <br clear="all" />
            <!-- list of existing files for this op -->
            <div class="col-md-6" ng-if="OPFiles.length > 0">
                <span ng-repeat="f in OPFiles">
                    <ul style="padding-left: 0">
                        <li style="list-style:none;padding-bottom: 15px;">
                            <span class="col-sm-9 borderLess" style="padding:0">
                                <a class="btn borderLess" style="padding:0" title="{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})" ng-click="showFile(f)">{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})</a>
                            </span>
                        </li>
                    </ul>
                </span>
            </div>
            <!-- carousel of photo files -->
            <div class="col-md-6" ng-if="opImageFiles.length > 0" style="height:120px;">
                <uib-carousel interval="4000">
                    <uib-slide ng-repeat="f in opImageFiles">
                        <img ng-click="showImageModal(f.FILE_ID)" ng-src="{{serverURL}}/Files/{{f.FILE_ID}}/Item" />
                        <div class="carousel-caption">
                            <p>{{f.PATH || f.FILE_URL || f.FILE_ID}}</p>
                        </div>
                    </uib-slide>
                </uib-carousel>
            </div>
            <br clear="all" />

            <div ng-if="showFileForm">
                <hr />                
                <form class="form-horizontal" name="OPFILEForm">
                    <fieldset>

                        <!--Upload Single Image with validations*-->
                        <div ng-if="aFile.FILE_ID === undefined" class="form-group required" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="FILE">Upload File:</label>
                            <div class="col-md-9">
                                <input type="file" max="500000" file-model="aFile.File" />
                                <img ngf-thumbnail="aFile.File" style="height:60px" class="thumbnail">
                            </div>
                        </div>
                        <!-- File Type* -->
                        <div class="form-group required" ng-class="{'has-error':OPFILEForm.FILETYPE_ID.$invalid && OPFILEForm.FILETYPE_ID.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="FILETYPE_ID">File Type:</label>
                            <div class="col-md-6">
                                <select class="form-control" name="FILETYPE_ID" ng-model="aFile.FILETYPE_ID"
                                        ng-options="ft.FILETYPE_ID as ft.FILETYPE for ft in fileTypes" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <br clear="all" />

                        <!-- photo file upload fileType==1-->  <!-- all other file upload fileType > 2-->    <!--data file upload fileType==2 -->
                        <!--File URL (Photo, data, other)-->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="FILE_URL">File URL:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FILE_URL" ng-model="aFile.FILE_URL" type="text" />
                            </div>
                        </div>

                        <!--Source Name (photo)-->
                        <div class="form-group required" ng-if="aFile.FILETYPE_ID === 1" ng-class="{'has-error':OPFILEForm.FULLNAME.$invalid && OPFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="SOURCE_ID">Source Photographer:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                            </div>
                        </div>

                        <!--Source Name (all other)-->
                        <div class="form-group required" ng-if="aFile.FILETYPE_ID  > 2" ng-class="{'has-error':OPFILEForm.FULLNAME.$invalid && OPFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="SOURCE_ID">Source Name:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                            </div>
                        </div>

                        <!--Source Agency* (photo, allOther)-->
                        <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID > 2" class="form-group required" ng-class="{'has-error':OPFILEForm.AGENCY_ID.$invalid && OPFILEForm.AGENCY_ID.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="FILETYPE_ID">Source Agency:</label>
                            <div class="col-md-6">
                                <select class="form-control" name="AGENCY_ID" ng-model="aSource.AGENCY_ID"
                                        ng-options="a.AGENCY_ID as a.AGENCY_NAME for a in agencies" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Date Taken* (photo, allother) -->
                        <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID  > 2" class="form-group required" ng-class="{'has-error':OPFILEForm.SOURCE_DATE.$invalid && OPFILEForm.SOURCE_DATE.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="SOURCE_DATE">Date Taken:</label>
                            <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                <input class="form-control" name="sd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                       is-open="datepickrs.sd" ng-model="aSource.SOURCE_DATE" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" ng-click="open($event, 'sd')">
                                        <i class="glyphicon glyphicon-calendar" />
                                    </button>
                                </span>
                            </div>
                        </div>

                        <!-- Date Uploaded* (photo, data, allother) -->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':OPFILEForm.FILE_DATE.$invalid && OPFILEForm.FILE_DATE.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="FILE_DATE">Date Uploaded:</label>
                            <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                <input class="form-control" name="fd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                       is-open="datepickrs.fd" ng-model="aFile.FILE_DATE" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" ng-click="open($event, 'fd')">
                                        <i class="glyphicon glyphicon-calendar" />
                                    </button>
                                </span>
                            </div>
                        </div>

                        <!--Description*(photo, data, allother)-->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':OPFILEForm.DESCRIPTION.$invalid && OPFILEForm.DESCRIPTION.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="DESCRIPTION">Description:</label>
                            <div class="col-md-6">
                                <textarea class="form-control" id="DESCRIPTION" type="text" rows="3" placeholder="Description" ng-model="aFile.DESCRIPTION" required />
                            </div>
                        </div>

                        <!-- This is where Other ends, rest is for Photo -->
                        <!--Photo Direction (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0;padding-top:5px;">
                            <label class="col-md-3 control-label" for="PHOTO_DIRECTION">Photo Direction:</label>
                            <div class="col-md-6">
                                <input class="form-control" id="PHOTO_DIRECTION" name="PHOTO_DIRECTION" ng-model="aFile.PHOTO_DIRECTION" type="text" />
                            </div>
                        </div>

                        <!-- Photo Latitude (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="LATITUDE_DD">Photo Latitude <br /> (if different):</label>
                            <div class="col-md-6">
                                <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="aFile.LATITUDE_DD"
                                       type="text" />
                            </div>
                        </div>

                        <!--Photo Longitude (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="LONGITUDE_DD">Photo Longitude <br /> (if different):</label>
                            <div class="col-md-6">
                                <input class="form-control" ng-keypress="isNum($event)" id="LONGITUDE_DD" name="LONGITUDE_DD" ng-model="aFile.LONGITUDE_DD"
                                       type="text" />
                            </div>
                        </div>

                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="Caption">Preview Caption:</button></label>
                            <div class="col-md-6">
                                <span>
                                    Photo of {{aFile.DESCRIPTION || ' (Description HERE) '}} at {{thisOPsite.SITE_DESCRIPTION}}, {{thisOPsite.COUNTY}}, {{thisOPsite.STATE}}, {{aSource.SOURCE_DATE | date: 'MM/dd/yyyy' || ' Date taken HERE '}}. Photograph by {{aSource.FULLNAME || ' Source Name HERE ' }}, {{(agencies | filter :{AGENCY_ID: aSource.AGENCY_ID})[0].AGENCY_NAME || ' Agency HERE '}}.
                                </span>
                            </div>
                        </div>

                        <div ng-show="aFile.FILE_ID !== undefined" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label">Associated File:</label>
                            <div class="col-md-6">
                                <a target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item">Download File</a>
                                <img ng-if="aFile.FILETYPE_ID === 1" style="height:80px;" ng-src="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item" />
                            </div>
                        </div>
                       
                        <div ng-show="!fileIsUploading">
                            <button class="btn btn-primary" ng-if="aFile.FILE_ID != undefined" ng-click="saveFile(OPFILEForm.$valid)">Save File</button>
                            <button class="btn btn-danger" ng-if="aFile.FILE_ID != undefined" ng-click="deleteFile()">Delete File</button>
                            <button class="btn btn-primary" ng-if="aFile.FILE_ID == undefined" ng-click="createFile(OPFILEForm.$valid)">Create File</button>
                            <button class="btn btn-warning" type="button" ng-click="cancelFile()">Cancel File</button>
                        </div>
                        <div ng-show="fileIsUploading"><img src="images/fileUpload.gif" /></div>
                        
                    </fieldset>
                </form>
            </div>
        </div>
    </div> <!-- end modal-body -->
    <br clear="all" />
    <div class="modal-footer">

    </div> <!-- end modal-footer -->
</script>

<!-- MODAL for HWM-->
<script type="text/ng-template" id="HWMmodal.html">
    <div class="modal-header">
        <h3 class="modal-title">HWM<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>

    <div class="modal-body">
        <form class="form-horizontal" name="HWMForm">
            <fieldset>
                <!-- Waterbody: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="WATERBODY">Waterbody:</label>
                    <div class="col-md-6">
                        <input class="form-control" name="WATERBODY" ng-model="aHWM.WATERBODY" type="text" />
                    </div>
                </div>

                <!-- Event: -->
                <div class="form-group" ng-class="{'has-error':HWMForm.EVENT_ID.$invalid && HWMForm.EVENT_ID.$dirty}">
                    <label class="col-md-3 control-label" for="EVENT_ID">Event:</label>
                    <div class="col-md-6">
                        <div class="col-md-8">{{EventName}}</div>
                        <div class="col-md-3" ng-show="userRole == 'Admin' && aHWM.HWM_ID != undefined">
                            <button type="button" ng-click="showChangeEventDD()" class="btn btn-primary">Change Event</button>
                        </div>
                    </div>
                </div>

                <!--Event dropdown for admin -->
                <div ng-show="showEventDD">
                    <div class="form-group">
                        <label class="col-md-3 control-label">Events:</label>
                        <div class="col-md-6">
                            <select class="form-control" name="EVENT_ID" ng-model="adminChanged.EVENT_ID" ng-change="ChangeEvent()"
                                    ng-options="e.EVENT_ID as (e.EVENT_NAME + ' --- ' + (e.EVENT_START_DATE | date: 'MM/dd/yyyy') + ' to ' + ((e.EVENT_END_DATE || '-Not Set-') | date: 'MM/dd/yyyy'))  for e in eventList | orderBy: '-EVENT_START_DATE'"
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- HWM Type:* -->
                <div class="form-group required" ng-class="{'has-error':HWMForm.HWM_TYPE_ID.$invalid && HWMForm.HWM_TYPE_ID.$dirty}">
                    <label class="col-md-3 control-label req" for="HWM_TYPE_ID">HWM Type:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="HWM_TYPE_ID" ng-model="aHWM.HWM_TYPE_ID"
                                ng-options="htype.HWM_TYPE_ID as htype.HWM_TYPE for htype in hwmTypeList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- HWM Environment:* -->
                <div class="form-group required" ng-class="{'has-error':HWMForm.HWM_ENVIRONMENT.$invalid && HWMForm.HWM_ENVIRONMENT.$dirty}">
                    <label class="col-md-3 control-label req">HWM Environment:</label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="HWM_ENVIRONMENT" ng-model="aHWM.HWM_ENVIRONMENT" value="Coastal" />Coastal
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="HWM_ENVIRONMENT" ng-model="aHWM.HWM_ENVIRONMENT" value="Riverine" />Riverine
                        </label>
                    </div>
                </div>

                <!-- Breakdown of categories -->
                <div class="form-group">
                    <label class="col-md-3"></label>
                    <div class="col-md-6">
                        <table>
                            <tr><td style="text-align: center;width: 81px">0.05</td><td style="text-align: center;width: 81px">0.02</td><td style="text-align: left;width: 81px">Excellent</td></tr>
                            <tr><td style="text-align: center;width: 81px">0.1</td><td style="text-align: center;width: 81px">0.05</td><td style="text-align: left;width: 81px">Good</td></tr>
                            <tr><td style="text-align: center;width: 81px">0.2</td><td style="text-align: center;width: 81px">0.1</td><td style="text-align: left;width: 81px">Fair</td></tr>
                            <tr><td style="text-align: center;width: 81px">0.4</td><td style="text-align: center;width: 81px">0.2</td><td style="text-align: left;width: 81px">Poor</td></tr>
                            <tr><td style="text-align: center;width: 81px">&#62;0.40</td><td style="text-align: center;width: 81px">&#62;0.20</td><td style="text-align: left;width: 81px">V. Poor</td></tr>
                            <tr><td colspan="3"><a href="http://pubs.usgs.gov/tm/11d1/" target="_blank">USGS T&M 11-D1, Table 13</a></td></tr>
                        </table>
                    </div>
                </div>

                <!-- HWM Quality:* -->
                <div class="form-group required" ng-class="{'has-error':HWMForm.HWM_QUALITY_ID.$invalid && HWMForm.HWM_QUALITY_ID.$dirty}">
                    <label class="col-md-3 control-label req">HWM Quality:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="HWM_QUALITY_ID" ng-model="aHWM.HWM_QUALITY_ID"
                                ng-options="hqual.HWM_QUALITY_ID as hqual.HWM_QUALITY for hqual in hwmQualList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Bank: -->
                <div class="form-group">
                    <label class="col-md-3 control-label">Bank:</label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="BANK" ng-model="aHWM.BANK" value="Left" />Left
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="BANK" ng-model="aHWM.BANK" value="Right" />Right
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="BANK" ng-model="aHWM.BANK" value="N/A" />N/A
                        </label>
                    </div>
                </div>

                <!-- Location Description: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="HWM_LOCATIONDESCRIPTION">Location Description:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" name="HWM_LOCATIONDESCRIPTION" type=" text" rows="3" ng-model="aHWM.HWM_LOCATIONDESCRIPTION" />
                    </div>
                </div>

                <!-- dec deg or dms: -->
                <div class="form-group">
                    <label class="col-md-3 control-label"></label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="decDegORdms" ng-change="latLongChange()" ng-model="aHWM.decDegORdms" value="dd" /> Dec Deg
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="decDegORdms" ng-change="latLongChange()" ng-model="aHWM.decDegORdms" value="dms" /> DMS
                        </label>
                    </div>
                </div>

                <!-- Latitude: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="LATITUDE_DD">Latitude:</label>
                    <div class="col-md-6" ng-if="aHWM.decDegORdms == 'dd'">
                        <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="aHWM.LATITUDE_DD" type="text" />
                    </div>
                    <div class="col-md-6" ng-if="aHWM.decDegORdms == 'dms'">
                        <table>
                            <tr>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Deg" ng-model="DMS.LADeg" type="text" /></td>
                                <td>°</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Min" ng-model="DMS.LAMin" type="text" /></td>
                                <td>′</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Sec" ng-model="DMS.LASec" type="text" /></td>
                                <td>″</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Longitude: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="LONGITUDE_DD">Longitude:</label>
                    <div class="col-md-6" ng-if="aHWM.decDegORdms == 'dd'">
                        <input class="form-control" ng-keypress="isNum($event)" id="longitude_dd" name="LONGITUDE_DD" ng-model="aHWM.LONGITUDE_DD" type="text" />
                    </div>
                    <div class="col-md-6" ng-if="aHWM.decDegORdms == 'dms'">
                        <table>
                            <tr>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Deg" ng-model="DMS.LODeg" type="text" /></td>
                                <td>°</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Min" ng-model="DMS.LOMin" type="text" /></td>
                                <td>′</td>
                                <td><input class="form-control" ng-keypress="isNum($event)" name="Sec" ng-model="DMS.LOSec" type="text" /></td>
                                <td>″</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Horizontal Datum:* -->
                <div class="form-group required" ng-class="{'has-error':HWMForm.HDATUM_ID.$invalid && HWMForm.HDATUM_ID.$dirty}">
                    <label class="col-md-3 control-label req">Horizontal Datum:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="HDATUM_ID" ng-model="aHWM.HDATUM_ID"
                                ng-options="hd.DATUM_ID as hd.DATUM_NAME for hd in HDatumsList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Horizontal Collection Method: * -->
                <div class="form-group required" ng-class="{'has-error':HWMForm.HCOLLECT_METHOD_ID.$invalid && HWMForm.HCOLLECT_METHOD_ID.$dirty}">
                    <label class="col-md-3 control-label req">Horizontal Collection Method:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="HCOLLECT_METHOD_ID" ng-model="aHWM.HCOLLECT_METHOD_ID"
                                ng-options="hcm.HCOLLECT_METHOD_ID as hcm.HCOLLECT_METHOD for hcm in hCollMList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Surveyed Elevation (ft): -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="ELEV_FT">Surveyed Elevation (ft):</label>
                    <div class="col-md-6">
                        <input class="form-control" ng-keypress="isNum($event)" name="ELEV_FT" ng-model="aHWM.ELEV_FT" type="text" />
                    </div>
                </div>

                <!-- Vertical Datum: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="VDATUM_ID">Vertical Datum:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="VDATUM_ID" ng-model="aHWM.VDATUM_ID"
                                ng-options="vd.DATUM_ID as vd.DATUM_NAME for vd in VDatumsList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Height above ground (ft): -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="HEIGHT_ABOVE_GND">Height above ground (ft):</label>
                    <div class="col-md-6">
                        <input class="form-control" ng-keypress="isNum($event)" name="HEIGHT_ABOVE_GND" ng-model="aHWM.HEIGHT_ABOVE_GND" type="text" />
                    </div>
                </div>

                <!-- Flagged Date: * -->
                <div class="form-group required" ng-class="{'has-error':HWMForm.FLAG_DATE.$invalid && HWMForm.FLAG_DATE.$dirty}">
                    <label class="col-md-3 control-label req" for="FLAG_DATE">Flagged Date:</label>
                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                        <input disabled="disabled" show-weeks="false" class="form-control" id="FLAG_DATE" name="fd" type="text" uib-datepicker-popup="MMM dd, yyyy"
                               is-open="datepickrs.fd" ng-model="aHWM.FLAG_DATE" required />
                        <span class="input-group-btn">
                            <button class="btn btn-default" ng-click="open($event, 'fd')">
                                <i class="glyphicon glyphicon-calendar" />
                            </button>
                        </span>
                    </div>
                </div>

                <!-- Surveyed Date: -->
                <div class="form-group" ng-class="{'has-error':HWMForm.SURVEY_DATE.$invalid && HWMForm.SURVEY_DATE.$dirty}">
                    <label class="col-md-3 control-label" for="SURVEY_DATE">Surveyed Date:</label>
                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                        <input disabled="disabled" show-weeks="false" class="form-control" id="SURVEY_DATE" name="sd" type="text" uib-datepicker-popup="MMM dd, yyyy"
                               is-open="datepickrs.sd" ng-model="aHWM.SURVEY_DATE" />
                        <span class="input-group-btn">
                            <button class="btn btn-default" ng-click="open($event, 'sd')">
                                <i class="glyphicon glyphicon-calendar" />
                            </button>
                        </span>
                    </div>
                </div>

                <!-- Vertical Collection Method: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="VDATUM_ID">Vertical Collection Method:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="VCOLLECT_METHOD_ID" ng-model="aHWM.VCOLLECT_METHOD_ID"
                                ng-options="vcm.VCOLLECT_METHOD_ID as vcm.VCOLLECT_METHOD for vcm in vCollMList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Marker: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="MARKER_ID">Marker:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="MARKER_ID" ng-model="aHWM.MARKER_ID"
                                ng-options="vd.MARKER_ID as vd.MARKER1 for vd in markerList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Notes: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="HWM_NOTES">Notes:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" name="HWM_NOTES" type=" text" rows="3" ng-model="aHWM.HWM_NOTES" />
                    </div>
                </div>

                <!-- Stillwater Location? -->
                <div class="form-group">
                    <label class="col-md-3 control-label">Stillwater Location?:</label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="STILLWATER" ng-model="aHWM.STILLWATER" value="1" />Yes
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="STILLWATER" ng-model="aHWM.STILLWATER" value="0" />No
                        </label>
                    </div>
                </div>

                <!-- Flagging Member: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="FLAG_TEAM_ID">Flagging Member:</label>
                    <div class="col-md-6">
                        <span>{{FlagMember.FNAME}} {{FlagMember.LNAME}}</span>
                    </div>
                </div>

                <!-- Survey Member: -->
                <div class="form-group" ng-show="aHWM.SURVEY_TEAM_ID">
                    <label class="col-md-3 control-label" for="SURVEY_TEAM_ID">Survey Member:</label>
                    <div class="col-md-6">
                        <span>{{SurveyMember.FNAME}} {{SurveyMember.LNAME}}</span>
                    </div>
                </div>

                <!-- Approval info -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="APPROVAL_ID">Approval Info:</label>
                    <div class="col-md-6">
                        <span>Approved By:</span><span ng-if="ApprovalInfo.Member"> {{ApprovalInfo.Member.FNAME || '---'}} {{ApprovalInfo.Member.LNAME || '---'}}</span><br />
                        <span>On:</span><span ng-if="ApprovalInfo.approvalDate"> {{ApprovalInfo.approvalDate | date: 'MM/dd/yyyy hh:mm a' || '---'}}</span>
                        <button ng-if="ApprovalInfo.approvalDate" type="button" class="borderLess" tooltip-placement="right" uib-tooltip="Time displayed as local, stored in UTC.">
                            <span class="glyphicon glyphicon-question-sign"></span>
                        </button>
                    </div>
                </div>

                <!-- form buttons -->
                <div class="form-group">
                    <div class="col-md-12">
                        <span><button ng-show="aHWM.HWM_ID == undefined" class="btn btn-primary" ng-click="create(HWMForm.$valid)"><span>Create</span></button></span>
                        <span><button ng-show="aHWM.HWM_ID != undefined" ng-disabled="showFileForm" class="btn btn-primary" ng-click="save(HWMForm.$valid)"><span>Save</span></button></span>
                        <span><button ng-show="(aHWM.HWM_ID != undefined && ApprovalInfo.approvalDate == undefined) && (userRole == 'Admin' || userRole == 'Manager')" class="btn btn-primary" ng-click="approveHWM(HWMForm.$valid)"><span>Approve</span></button></span>
                        <span><button ng-show="(aHWM.HWM_ID != undefined && ApprovalInfo.approvalDate != undefined) && (userRole == 'Admin' || userRole == 'Manager')" class="btn btn-primary" ng-click="unApproveHWM(HWMForm.$valid)"><span>UnApprove</span></button></span>
                        <span><button ng-show="aHWM.HWM_ID != undefined" ng-disabled="showFileForm" class="btn btn-danger" ng-click="deleteHWM(HWMForm.$valid)"><span>Delete</span></button></span>
                        <span><button type="button" class="btn btn-warning" ng-disabled="showFileForm" ng-click="cancel()"><span>Cancel/Close</span></button></span>
                    </div>
                </div>
            </fieldset>
        </form>
        <!-- HWM FILES SECTION -->
        <div ng-if="aHWM.HWM_ID !== undefinfed" class="col-md-12">
            <div class="col-md-4"><h3>HWM Files</h3></div>
            <div class="col-md-6" ng-if="!showFileForm" style="margin-top:14px">
                <button type="button" class="borderLess" ng-click="showFile(0)" tooltip-placement="right" uib-tooltip="Upload a new File to this HWM">
                    <span class="glyphicon glyphicon-plus"></span>
                </button>
            </div>
            <br clear="all" />
            <!-- list of existing files for this hwm -->
            <div class="col-md-6" ng-if="HWMFiles.length > 0">
                <span ng-repeat="f in HWMFiles">
                    <ul style="padding-left: 0">
                        <li style="list-style:none;padding-bottom: 15px;">
                            <span class="col-sm-9 borderLess" style="padding:0">
                                <a class="btn borderLess" style="padding:0" title="{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})" ng-click="showFile(f)">{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})</a>
                            </span>
                        </li>
                    </ul>
                </span>
            </div>
            <!-- carousel of photo files -->
            <div class="col-md-6" ng-if="hwmImageFiles.length > 0" style="height:120px;">
                <uib-carousel interval="4000">
                    <uib-slide ng-repeat="f in hwmImageFiles">
                        <img ng-click="showImageModal(f.FILE_ID)" ng-src="{{serverURL}}/Files/{{f.FILE_ID}}/Item" />
                        <div class="carousel-caption">
                            <p>{{f.PATH || f.FILE_URL || f.FILE_ID}}</p>
                        </div>
                    </uib-slide>
                </uib-carousel>
            </div>
            <br clear="all" />

            <div ng-if="showFileForm">
                <hr />
                <form class="form-horizontal" name="HWMFILEForm">
                    <fieldset>
                        <!--Upload Single Image with validations*-->
                        <div ng-if="aFile.FILE_ID === undefined" class="form-group required" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="FILE">Upload File:</label>
                            <div class="col-md-9">
                                <input type="file" max="500000" file-model="aFile.File" />
                                <img ngf-thumbnail="aFile.File" style="height:60px" class="thumbnail">
                            </div>
                        </div>
                        <!-- File Type* -->
                        <div class="form-group required" ng-class="{'has-error':HWMFILEForm.FILETYPE_ID.$invalid && HWMFILEForm.FILETYPE_ID.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="FILETYPE_ID">File Type:</label>
                            <div class="col-md-6">
                                <select class="form-control" name="FILETYPE_ID" ng-model="aFile.FILETYPE_ID"
                                        ng-options="ft.FILETYPE_ID as ft.FILETYPE for ft in fileTypes" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <br clear="all" />

                        <!-- photo file upload fileType==1-->  <!-- all other file upload fileType > 2-->    <!--data file upload fileType==2 -->
                        <!--File URL (Photo, data, other)-->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="FILE_URL">File URL:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FILE_URL" ng-model="aFile.FILE_URL" type="text" />
                            </div>
                        </div>

                        <!--Source Name (photo)-->
                        <div class="form-group required" ng-if="aFile.FILETYPE_ID === 1" ng-class="{'has-error':HWMFILEForm.FULLNAME.$invalid && HWMFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="SOURCE_ID">Source Photographer:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                            </div>
                        </div>

                        <!--Source Name (all other)-->
                        <div class="form-group required" ng-if="aFile.FILETYPE_ID  > 2" ng-class="{'has-error':HWMFILEForm.FULLNAME.$invalid && HWMFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="SOURCE_ID">Source Name:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                            </div>
                        </div>

                        <!--Source Agency* (photo, allOther)-->
                        <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID > 2" class="form-group required" ng-class="{'has-error':HWMFILEForm.AGENCY_ID.$invalid && HWMFILEForm.AGENCY_ID.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="FILETYPE_ID">Source Agency:</label>
                            <div class="col-md-6">
                                <select class="form-control" name="AGENCY_ID" ng-model="aSource.AGENCY_ID"
                                        ng-options="a.AGENCY_ID as a.AGENCY_NAME for a in agencies" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Date Taken* (photo, allother) -->
                        <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID  > 2" class="form-group required" ng-class="{'has-error':HWMFILEForm.SOURCE_DATE.$invalid && HWMFILEForm.SOURCE_DATE.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="SOURCE_DATE">Date Taken:</label>
                            <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                <input class="form-control" name="sd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                       is-open="datepickrs.sd" ng-model="aSource.SOURCE_DATE" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" ng-click="open($event, 'sd')">
                                        <i class="glyphicon glyphicon-calendar" />
                                    </button>
                                </span>
                            </div>
                        </div>

                        <!-- Date Uploaded* (photo, data, allother) -->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':HWMFILEForm.FILE_DATE.$invalid && HWMFILEForm.FILE_DATE.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="FILE_DATE">Date Uploaded:</label>
                            <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                <input class="form-control" name="fd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                       is-open="datepickrs.fd" ng-model="aFile.FILE_DATE" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" ng-click="open($event, 'fd')">
                                        <i class="glyphicon glyphicon-calendar" />
                                    </button>
                                </span>
                            </div>
                        </div>

                        <!--Description*(photo, data, allother)-->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':HWMFILEForm.DESCRIPTION.$invalid && HWMFILEForm.DESCRIPTION.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-3 control-label req" for="DESCRIPTION">Description:</label>
                            <div class="col-md-6">
                                <textarea class="form-control" id="DESCRIPTION" type="text" rows="3" placeholder="Description" ng-model="aFile.DESCRIPTION" required />
                            </div>
                        </div>

                        <!-- This is where Other ends, rest is for Photo -->
                        <!--Photo Direction (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0;padding-top:5px;">
                            <label class="col-md-3 control-label" for="PHOTO_DIRECTION">Photo Direction:</label>
                            <div class="col-md-6">
                                <input class="form-control" id="PHOTO_DIRECTION" name="PHOTO_DIRECTION" ng-model="aFile.PHOTO_DIRECTION" type="text" />
                            </div>
                        </div>

                        <!-- Photo Latitude (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="LATITUDE_DD">Photo Latitude <br /> (if different):</label>
                            <div class="col-md-6">
                                <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="aFile.LATITUDE_DD"
                                       type="text" />
                            </div>
                        </div>

                        <!--Photo Longitude (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="LONGITUDE_DD">Photo Longitude <br /> (if different):</label>
                            <div class="col-md-6">
                                <input class="form-control" ng-keypress="isNum($event)" id="LONGITUDE_DD" name="LONGITUDE_DD" ng-model="aFile.LONGITUDE_DD"
                                       type="text" />
                            </div>
                        </div>

                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label" for="Caption">Preview Caption:</button></label>
                            <div class="col-md-6">
                                <span>
                                    Photo of {{aFile.DESCRIPTION || ' (Description HERE) '}} at {{thisHWMsite.SITE_DESCRIPTION}}, {{thisHWMsite.COUNTY}}, {{thisHWMsite.STATE}}, {{aSource.SOURCE_DATE | date: 'MM/dd/yyyy' || ' Date taken HERE '}}. Photograph by {{aSource.FULLNAME || ' Source Name HERE ' }}, {{(agencies | filter :{AGENCY_ID: aSource.AGENCY_ID})[0].AGENCY_NAME || ' Agency HERE '}}.
                                </span>
                            </div>
                        </div>

                        <div ng-if="aFile.FILE_ID !== undefined" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-3 control-label">Associated File:</label>
                            <div class="col-md-6">
                                <a target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item">Download File</a>
                                <img ng-if="aFile.FILETYPE_ID === 1" style="height:80px;" ng-src="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item" />
                            </div>
                        </div>
                        <div ng-show="!HWMfileIsUploading">
                            <button class="btn btn-primary" ng-if="aFile.FILE_ID != undefined" ng-click="saveFile(HWMFILEForm.$valid)">Save File</button>
                            <button class="btn btn-danger" ng-if="aFile.FILE_ID != undefined" ng-click="deleteFile()">Delete File</button>
                            <button class="btn btn-primary" ng-if="aFile.FILE_ID == undefined" ng-click="createFile(HWMFILEForm.$valid)">Create File</button>
                            <button class="btn btn-warning" type="button" ng-click="cancelFile()">Cancel File</button>
                        </div>
                        <div ng-show="HWMfileIsUploading"><img src="images/fileUpload.gif" /></div>
                    </fieldset>
                </form>
            </div>
        </div>
    </div> <!-- end modal-body -->
    <br clear="all" />

    <div class="modal-footer">

    </div> <!-- end modal-footer -->
</script>

<!-- MODAL for Proposed and Deployed Sensor-->
<script type="text/ng-template" id="Sensormodal.html">
    <div class="modal-header">
        <h3 class="modal-title">Deploy Sensor<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" name="SensorForm">
            <fieldset>
                <!-- Event: -->
                <div class="form-group" ng-class="{'has-error':SensorForm.EVENT_ID.$invalid && SensorForm.EVENT_ID.$dirty}">
                    <label class="col-md-3 control-label" for="EVENT_ID">Event:</label>
                    <div class="col-md-6">
                        <div class="col-md-8">{{EventName}}</div>
                        <div class="col-md-3" ng-show="userRole == 'Admin' && whichButton == 'edit'">
                            <button type="button" ng-click="showChangeEventDD()" class="btn btn-primary">Change Event</button>
                        </div>
                    </div>
                </div>

                <!--Event dropdown for admin -->
                <div ng-show="showEventDD">
                    <div class="form-group">
                        <label class="col-md-3 control-label" for="EVENT_ID">Events:</label>
                        <div class="col-md-6">
                            <select class="form-control" id="EVENT_ID" name="EVENT_ID" ng-model="adminChanged.EVENT_ID" ng-change="ChangeEvent()"
                                    ng-options="e.EVENT_ID as (e.EVENT_NAME + ' --- ' + (e.EVENT_START_DATE | date: 'MM/dd/yyyy') + ' to ' + ((e.EVENT_END_DATE || '-Not Set-') | date: 'MM/dd/yyyy'))  for e in eventList | orderBy: '-EVENT_START_DATE'"
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Sensor Type:* -->
                <div class="form-group required" ng-class="{'has-error':SensorForm.SENSOR_TYPE_ID.$invalid && SensorForm.SENSOR_TYPE_ID.$dirty}">
                    <label class="col-md-3 control-label req" for="SENSOR_TYPE_ID">Sensor Type:</label>
                    <div class="col-md-6">
                        <select class="form-control" id="SENSOR_TYPE_ID" name="SENSOR_TYPE_ID" ng-model="aSensor.SENSOR_TYPE_ID"
                                ng-options="s.SENSOR_TYPE_ID as s.SENSOR for s in sensorTypeList" ng-change="getDepTypes()" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Sensor Brand:* -->
                <div class="form-group required" ng-class="{'has-error':SensorForm.SENSOR_BRAND_ID.$invalid && SensorForm.SENSOR_BRAND_ID.$dirty}">
                    <label class="col-md-3 control-label req" for="SENSOR_BRAND_ID">Sensor Brand:</label>
                    <div class="col-md-6">
                        <select class="form-control" id="SENSOR_BRAND_ID" name="SENSOR_BRAND_ID" ng-model="aSensor.SENSOR_BRAND_ID"
                                ng-options="sb.SENSOR_BRAND_ID as sb.BRAND_NAME for sb in sensorBrandList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Serial Number:* -->
                <div class="form-group required" ng-class="{'has-error':SensorForm.SERIAL_NUMBER.$invalid && SensorForm.SERIAL_NUMBER.$dirty}">
                    <label class="col-md-3 control-label req" for="SERIAL_NUMBER">Serial Number:</label>
                    <div class="col-md-6">
                        <input class="form-control" name="SERIAL_NUMBER" ng-model="aSensor.SERIAL_NUMBER" type="text" required />
                    </div>
                </div>

                <!-- Housing Serial Number: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="HOUSING_SERIAL_NUMBER">Housing Serial Number:</label>
                    <div class="col-md-6">
                        <input class="form-control" name="HOUSING_SERIAL_NUMBER" ng-model="aSensor.HOUSING_SERIAL_NUMBER" type="text" />
                    </div>
                </div>

                <!-- Housing Types: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="HOUSING_TYPE_ID">Housing Types:</label>
                    <div class="col-md-6">
                        <select class="form-control" id="HOUSING_TYPE_ID" name="HOUSING_TYPE_ID" ng-model="aSensor.HOUSING_TYPE_ID"
                                ng-options="ht.HOUSING_TYPE_ID as ht.TYPE_NAME for ht in houseTypeList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- -------------------------- START TAPEDOWN SECTION --------------------------------  -->
                <!--Add Tapedown button-->
                <div ng-if="OPsPresent" class="form-group">
                    <label class="col-md-3 control-label" for="TAPEDOWNBTN">Tape Down:</label>
                    <div class="col-md-6">
                        <button type="button" ng-click="showTapedownPart()" class="btn btn-primary">Show/Hide Tape Down Information</button>
                    </div>
                </div>
                <div ng-if="!OPsPresent" class="form-group">
                    <label class="col-md-3 control-label" for="TAPEDOWNBTN">Tape Down:</label>
                    <div class="col-md-6">
                        <span>No Datum Locations added to this site for tapedown</span>
                    </div>
                </div>

                <!--start add tapedown area -->
                <div ng-if="addTapedown">
                    <hr />
                    <div class="form-group">
                        <label class="col-md-3 control-label">Datum Location(s):</label>
                        <div class="col-md-6">
                            <div isteven-multi-select
                                 input-model="OPsForTapeDown"
                                 output-model="OPMeasure"
                                 button-label="NAME"
                                 item-label="NAME"
                                 on-item-click="OPchosen(data)"
                                 tick-property="selected"
                                 helper-elements="filter">

                            </div>
                        </div>
                    </div>

                    <br clear="all" />
                    <div ng-show="tapeDownTable.length > 0">
                        <div class="pull-right col-md-6"><em>Note: these are not used for any calculations but are to facilitate field activities</em></div>
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th>Datum Location</th>
                                    <th>Elevation</th>
                                    <th class="col-md-2">Offset Correction</th>
                                    <th class="col-md-2">Water Surface</th>
                                    <th class="col-md-2">Ground Surface</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="t in tapeDownTable">
                                    <td>{{t.OP_NAME}}<input type="hidden" ng-model="t.OBJECTIVE_TYPE_ID" /><input type="hidden" ng-model="t.OP_MEASUREMENTS_ID" /></td>
                                    <td>
                                        {{t.elevation}} {{t.Vdatum}}
                                    </td>
                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="t.OFFSET_CORRECTION" /></td>
                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="t.WATER_SURFACE" /></td>
                                    <td><input class="form-control" ng-keypress="isnum($event)" ng-model="t.GROUND_SURFACE" /></td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- Sensor status fields for tapedown -->
                        <div class="col-md-6">
                            <div class="form-group" style="margin-bottom:0">
                                <label class="col-md-6 control-label" for="SENSOR_ELEVATION">Sensor Elevation:</label>
                                <div class="col-md-6">
                                    <input class="form-control" ng-keypress="isNum($event)" name="SENSOR_ELEVATION" ng-model="aSensStatus.SENSOR_ELEVATION" type="text" />
                                </div>
                            </div>

                            <div class="form-group" style="margin-bottom:0">
                                <label class="col-md-6 control-label" for="WS_ELEVATION">Water Surface Elevation:</label>
                                <div class="col-md-6">
                                    <input class="form-control" ng-keypress="isNum($event)" name="WS_ELEVATION" ng-model="aSensStatus.WS_ELEVATION" type="text" />
                                </div>
                            </div>

                            <div class="form-group" style="margin-bottom:0">
                                <label class="col-md-6 control-label" for="GS_ELEVATION">Ground Elevation:</label>
                                <div class="col-md-6">
                                    <input class="form-control" ng-keypress="isNum($event)" name="GS_ELEVATION" ng-model="aSensStatus.GS_ELEVATION" type="text" />
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-6 control-label req" for="VDATUM_ID">In feet above:</label>
                                <div class="col-md-6">
                                    <select class="form-control" id="VDATUM_ID" name="VDATUM_ID" ng-model="aSensStatus.VDATUM_ID"
                                            ng-options="vd.DATUM_ID as vd.DATUM_ABBREVIATION for vd in vertDatumList">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                            <div class="pull-left col-md-12"><em>Note: these elevations are used in the sensor processing and the final products</em></div>
                        </div>

                        <!-- area for D3 vertical ruler
                        <div class="col-md-6">
                            <bars-chart elevation-data="myData"></bars-chart>
                        </div> -->
                    </div>
                    <br clear="all" />
                    <hr />
                </div>

                <!-- -------------------------- END TAPEDOWN SECTION --------------------------------  -->
                <!-- Vented (only if Sensor Type is Pressure Transducer)-->
                <div ng-show="aSensor.SENSOR_TYPE_ID == 1">
                    <div class="form-group">
                        <label class="col-md-3 control-label">Vented:</label>
                        <div class="col-md-6">
                            <label class="radio-inline">
                                <input type="radio" name="VENTED" ng-model="aSensor.VENTED" value="Yes" />Yes
                            </label>
                            <label class="radio-inline">
                                <input type="radio" name="VENTED" ng-model="aSensor.VENTED" value="No" />No
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Deployment Type: -->
                <div class="form-group">
                    <label class="col-md-3 control-label req" for="DEPLOYMENT_TYPE_ID">Deployment Type:</label>
                    <div class="col-md-6">
                        <select class="form-control" id="DEPLOYMENT_TYPE_ID" name="DEPLOYMENT_TYPE_ID" ng-model="aSensor.DEPLOYMENT_TYPE_ID"
                                ng-options="dt.DEPLOYMENT_TYPE_ID as dt.METHOD for dt in filteredDeploymentTypes">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Location Description: -->
                <div class="form-group" ng-class="{'has-error':SensorForm.LOCATION_DESCRIPTION.$invalid && SensorForm.LOCATION_DESCRIPTION.$dirty}">
                    <label class="col-md-3 control-label" for="LOCATION_DESCRIPTION">Location Description:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" id="LOCATION_DESCRIPTION" name="LOCATION_DESCRIPTION" type=" text" rows="3" ng-model="aSensor.LOCATION_DESCRIPTION" />
                    </div>
                </div>

                <!-- Interval: -->
                <div class="form-group" style="margin-bottom:0">
                    <label class="col-md-3 control-label" for="INTERVAL">Interval:</label>
                    <div class="col-md-6">
                        <input class="form-control" ng-keypress="isNum($event)" name="INTERVAL" ng-model="aSensor.INTERVAL" type="text" />
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-md-3 control-label"></label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="intervalType" ng-model="IntervalType.type" value="Minutes" />Minutes
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="intervalType" ng-model="IntervalType.type" value="Seconds" />Seconds
                        </label>
                    </div>
                </div>

                <!-- Deploy Time: * -->
                <div class="form-group required" ng-class="{'has-error':SensorForm.TIME_STAMP.$invalid && SensorForm.TIME_STAMP.$dirty}">
                    <label class="col-md-3 control-label req" style="margin-top:3%" for="TIME_STAMP">Deploy Time:</label>
                    <div class="col-md-6">
                        <datetimepicker hour-step="1" minute-step="1" ng-model="aSensStatus.TIME_STAMP" show-meridian="true"
                                        date-format="MM/dd/yyyy" readonly-date="false" readonly-time="false" date-options="dateOptions"
                                        hidden-time="false" hidden-date="false" show-spinners="true" required>
                        </datetimepicker>
                    </div>
                </div>

                <!-- Time Zone:* -->
                <div class="form-group required">
                    <label class="col-md-3 control-label" for="TIME_ZONE">Time Zone:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="TIME_ZONE" ng-model="aSensStatus.TIME_ZONE"
                                ng-options="vcm for vcm in timeZoneList" required>
                            <option value=""></option>
                        </select>
                    </div>
                    <button type="button" class="borderLess" tooltip-placement="right" uib-tooltip="Date/Time will be stored in UTC.">
                        <span class="glyphicon glyphicon-question-sign"></span>
                    </button>
                </div>

                <!-- Note: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="NOTES">Note:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" name="NOTES" type=" text" rows="3" ng-model="aSensStatus.NOTES" elastic />
                    </div>
                </div>

                <!-- Collection Member: -->
                <div class="form-group">
                    <label class="col-md-3 control-label">Deploy Member:</label>
                    <div class="col-md-6">
                        <input type="hidden" name="MEMBER_ID" ng-model="aSensStatus.MEMBER_ID" />
                        <span>{{Deployer.FNAME}} {{Deployer.LNAME}}</span>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-12">
                        <span><button ng-if="whichButton == 'deploy' || whichButton == 'deployP'" class="btn btn-primary" ng-click="deploy(SensorForm.$valid)"><span>Deploy</span></button></span>
                        <span><button ng-show="whichButton == 'edit'" class="btn btn-primary" ng-disabled="showFileForm" ng-click="save(SensorForm.$valid)"><span>Save</span></button></span>
                        <span><button ng-show="whichButton == 'edit'" class="btn btn-danger" ng-disabled="showFileForm" ng-click="deleteS(SensorForm.$valid)"><span>Delete</span></button></span>
                        <span><button type="button" class="btn btn-warning" ng-disabled="showFileForm" ng-click="cancel()"><span>Cancel</span></button></span>
                    </div>
                </div>
            </fieldset>
        </form>

        <!-- Deployed Sensor FILES SECTION -->
        <div ng-if="aSensor.INSTRUMENT_ID !== undefined && aSensStatus.Status != 'Proposed'" class="col-md-12">
            <div class="col-md-5"><h3>Deployed Instrument Files</h3></div>
            <div class="col-md-6" ng-if="!showFileForm" style="margin-top:14px">
                <button type="button" class="borderLess" ng-click="showFile(0)" tooltip-placement="right" uib-tooltip="Upload a new File to this Sensor">
                    <span class="glyphicon glyphicon-plus"></span>
                </button>
            </div>
            <br clear="all" />
            <!-- list of existing files for this op -->
            <div class="col-md-6" ng-if="DepSensorFiles.length > 0">
                <span ng-repeat="f in DepSensorFiles">
                    <ul style="padding-left: 0">
                        <li style="list-style:none;padding-bottom: 15px;">
                            <span class="col-sm-9 borderLess" style="padding:0">
                                <a class="btn borderLess" style="padding:0" title="{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})" ng-click="showFile(f)">{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})</a>
                            </span>
                        </li>
                    </ul>
                </span>
            </div>
            <!-- carousel of photo files -->
            <div class="col-md-6" ng-if="depSensImageFiles.length > 0" style="height:120px;">
                <uib-carousel interval="4000">
                    <uib-slide ng-repeat="f in depSensImageFiles">
                        <img ng-click="showImageModal(f.FILE_ID)" ng-src="{{serverURL}}/Files/{{f.FILE_ID}}/Item" />
                        <div class="carousel-caption">
                            <p>{{f.PATH || f.FILE_URL || f.FILE_ID}}</p>
                        </div>
                    </uib-slide>
                </uib-carousel>
            </div>
            <br clear="all" />

            <div ng-if="showFileForm">
                <hr />
                <form class="form-horizontal" name="DepSenFILEForm">
                    <fieldset>
                        <!--Upload Single Image with validations*-->
                        <div ng-if="aFile.FILE_ID === undefined" class="form-group required" style="margin:0;padding:0">
                            <label class="col-md-4 control-label" for="FILE">Upload File:</label>
                            <div class="col-md-8">
                                <input type="file" max="500000" file-model="aFile.File" />
                                <img ngf-thumbnail="aFile.File" style="height:60px" class="thumbnail">
                            </div>
                        </div>
                        <!-- File Type* -->
                        <div class="form-group required" ng-class="{'has-error':DepSenFILEForm.FILETYPE_ID.$invalid && DepSenFILEForm.FILETYPE_ID.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="FILETYPE_ID">File Type:</label>
                            <div class="col-md-6">
                                <select class="form-control" name="FILETYPE_ID" ng-model="aFile.FILETYPE_ID"
                                        ng-options="ft.FILETYPE_ID as ft.FILETYPE for ft in fileTypes" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <br clear="all" />

                        <!-- photo file upload fileType==1-->  <!-- all other file upload fileType > 2-->    <!--data file upload fileType==2 -->
                        <!--File URL (Photo, data, other)-->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-4 control-label" for="FILE_URL">File URL:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FILE_URL" ng-model="aFile.FILE_URL" type="text" />
                            </div>
                        </div>

                        <!--Data Processed by (Data) -->
                        <div ng-if="aFile.FILETYPE_ID === 2" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-4 control-label" for="PROCESSOR_ID">Data Process By:</label>
                            <div class="col-md-6">
                                <span>{{processor.FNAME}} {{processor.LNAME}}</span>
                            </div>
                        </div>
                        <!-- Date Collected/Processed* (data)-->
                        <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.COLLECT_DATE.$invalid && DepSenFILEForm.COLLECT_DATE.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="COLLECT_DATE">Date Collected/Processed:</label>
                            <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                <input class="form-control" name="dfcd" type="text" uib-datepicker-popup="MMM dd, yyyy" show-weeks="false"
                                       disabled="disabled" is-open="datepickrs.dfcd" ng-model="datafile.COLLECT_DATE" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" ng-click="open($event, 'dfcd')">
                                        <i class="glyphicon glyphicon-calendar" />
                                    </button>
                                </span>
                            </div>
                        </div>

                        <!--Source Name (photo)-->
                        <div class="form-group required" ng-if="aFile.FILETYPE_ID === 1" ng-class="{'has-error':DepSenFILEForm.FULLNAME.$invalid && DepSenFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="SOURCE_ID">Source Photographer:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                            </div>
                        </div>

                        <!--Source Name (all other)-->
                        <div class="form-group required" ng-if="aFile.FILETYPE_ID  > 2" ng-class="{'has-error':DepSenFILEForm.FULLNAME.$invalid && DepSenFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="SOURCE_ID">Source Name:</label>
                            <div class="col-md-6">
                                <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                            </div>
                        </div>

                        <!--Source Agency* (photo, allOther)-->
                        <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID > 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.AGENCY_ID.$invalid && DepSenFILEForm.AGENCY_ID.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="FILETYPE_ID">Source Agency:</label>
                            <div class="col-md-6">
                                <select class="form-control" name="AGENCY_ID" ng-model="aSource.AGENCY_ID"
                                        ng-options="a.AGENCY_ID as a.AGENCY_NAME for a in agencies" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Date Taken* (photo, allother) -->
                        <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID  > 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.SOURCE_DATE.$invalid && DepSenFILEForm.SOURCE_DATE.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="SOURCE_DATE">Date Taken:</label>
                            <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                <input class="form-control" name="sd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                       is-open="datepickrs.sd" ng-model="aSource.SOURCE_DATE" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" ng-click="open($event, 'sd')">
                                        <i class="glyphicon glyphicon-calendar" />
                                    </button>
                                </span>
                            </div>
                        </div>

                        <!-- Date Uploaded* (photo, data, allother) -->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':DepSenFILEForm.FILE_DATE.$invalid && DepSenFILEForm.FILE_DATE.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="FILE_DATE">Date Uploaded:</label>
                            <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                <input class="form-control" name="fd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                       is-open="datepickrs.fd" ng-model="aFile.FILE_DATE" required />
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" ng-click="open($event, 'fd')">
                                        <i class="glyphicon glyphicon-calendar" />
                                    </button>
                                </span>
                            </div>
                        </div>

                        <!--Description*(photo, data, allother)-->
                        <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':DepSenFILEForm.DESCRIPTION.$invalid && DepSenFILEForm.DESCRIPTION.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="DESCRIPTION">Description:</label>
                            <div class="col-md-6">
                                <textarea class="form-control" id="DESCRIPTION" type="text" rows="3" placeholder="Description" ng-model="aFile.DESCRIPTION" required />
                            </div>
                        </div>

                        <!-- Good Data Start Time* (data) -->
                        <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.GOOD_START.$invalid && DepSenFILEForm.GOOD_START.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="GOOD_START" style="margin-top:4%">Good Data Start Time:</label>
                            <div class="col-md-6">
                                <datetimepicker ng-model="datafile.GOOD_START" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                                hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfgs" date-ng-click="open($event, 'dfgs')" required>
                                </datetimepicker>
                            </div>
                        </div>

                        <!-- Good Data End Time* (data)-->
                        <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.GOOD_END.$invalid && DepSenFILEForm.GOOD_END.$dirty}" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req" for="GOOD_END" style="margin-top:4%">Good Data End Time:</label>
                            <div class="col-md-6">
                                <datetimepicker ng-model="datafile.GOOD_END" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                                hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfge" date-ng-click="open($event, 'dfge')" required>
                                </datetimepicker>
                            </div>
                        </div>

                        <!-- Timezone*: -->
                        <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" style="margin:0;padding:0">
                            <label class="col-md-4 control-label req">Time Zone:</label>
                            <div class="col-md-6">
                                <select class="form-control" name="TIME_ZONE" ng-model="datafile.TIME_ZONE" ng-options="vcm for vcm in timeZoneList" required>
                                    <option value=""></option>
                                </select>
                            </div>
                            <button type="button" class="borderLess pull-left" tooltip-placement="right" tooltip-append-to-body="true" uib-tooltip="Date/Time will be stored in UTC.">
                                <span class="glyphicon glyphicon-question-sign"></span>
                            </button>
                        </div>

                        <!-- Elevation -->
                        <div ng-if="aFile.FILETYPE_ID === 2" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-4 control-label">Elevation:</label>
                            <div class="col-md-6">
                                <label class="radio-inline">
                                    <input type="radio" name="ELEVATION_STATUS" ng-model="datafile.ELEVATION_STATUS" value="Final" />Final
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="ELEVATION_STATUS" ng-model="datafile.ELEVATION_STATUS" value="Arbitrary" />Arbitrary
                                </label>
                            </div>
                        </div>
                        <!-- This is where Other ends, rest is for Photo -->
                        <!--Photo Direction (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0;padding-top:5px;">
                            <label class="col-md-4 control-label" for="PHOTO_DIRECTION">Photo Direction:</label>
                            <div class="col-md-6">
                                <input class="form-control" id="PHOTO_DIRECTION" name="PHOTO_DIRECTION" ng-model="aFile.PHOTO_DIRECTION" type="text" />
                            </div>
                        </div>

                        <!-- Photo Latitude (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-4 control-label" for="LATITUDE_DD">Photo Latitude <br /> (if different):</label>
                            <div class="col-md-6">
                                <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="aFile.LATITUDE_DD"
                                       type="text" />
                            </div>
                        </div>

                        <!--Photo Longitude (photo)-->
                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-4 control-label" for="LONGITUDE_DD">Photo Longitude <br /> (if different):</label>
                            <div class="col-md-6">
                                <input class="form-control" ng-keypress="isNum($event)" id="LONGITUDE_DD" name="LONGITUDE_DD" ng-model="aFile.LONGITUDE_DD"
                                       type="text" />
                            </div>
                        </div>

                        <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-4 control-label" for="Caption">Preview Caption:</button></label>
                            <div class="col-md-6">
                                <span>
                                    Photo of {{aFile.DESCRIPTION || ' (Description HERE) '}} at {{thisSensorSite.SITE_DESCRIPTION}}, {{thisSensorSite.COUNTY}}, {{thisSensorSite.STATE}}, {{aSource.SOURCE_DATE | date: 'MM/dd/yyyy' || ' Date taken HERE '}}. Photograph by {{aSource.FULLNAME || ' Source Name HERE ' }}, {{(agencies | filter :{AGENCY_ID: aSource.AGENCY_ID})[0].AGENCY_NAME || ' Agency HERE '}}.
                                </span>
                            </div>
                        </div>

                        <div ng-if="aFile.FILE_ID !== undefined" class="form-group" style="margin:0;padding:0">
                            <label class="col-md-4 control-label">Associated File:</label>
                            <div class="col-md-6">
                                <a target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item">Download File</a>
                                <img ng-if="aFile.FILETYPE_ID === 1" style="height:80px;" ng-src="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item" />
                            </div>
                        </div>
                        <div ng-show="!depSenfileIsUploading">
                            <button class="btn btn-primary" ng-if="aFile.FILE_ID != undefined" ng-click="saveFile(DepSenFILEForm.$valid)">Save File</button>
                            <button class="btn btn-danger" ng-if="aFile.FILE_ID != undefined" ng-click="deleteFile()">Delete File</button>
                            <button class="btn btn-primary" ng-if="aFile.FILE_ID == undefined" ng-click="createFile(DepSenFILEForm.$valid)">Create File</button>
                            <button class="btn btn-warning" type="button" ng-click="cancelFile()">Cancel File</button>
                        </div>
                        <div ng-show="depSenfileIsUploading"><img src="images/fileUpload.gif" /></div>
                    </fieldset>
                </form>
            </div>
        </div>
    </div> <!-- end modal-body -->
    <br clear="all" />

    <div class="modal-footer">

    </div><!-- end modal-footer -->

</script>


<!-- MODAL for Retrieving a Sensor-->
<script type="text/ng-template" id="SensorRetrievalModal.html">
    <div class="modal-header">
        <h3 class="modal-title">Retrieve Sensor<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>

    <form class="form-horizontal" name="SensorFormR">
        <fieldset>
            <div class="modal-body">
                <label>Deployed Sensor Information</label>

                <!-- Event: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Event:</div>
                    <div class="col-md-6">{{EventName}}</div>
                </div>
                <!-- Sensor Type: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Sensor Type:</div>
                    <div class="col-md-6">{{aSensor.Sensor_Type || '---'}}</div>
                </div>
                <!-- Sensor Brand: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Sensor Brand:</div>
                    <div class="col-md-6">{{aSensor.Sensor_Brand || '---'}}</div>
                </div>
                <!-- Serial Number: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Serial Number:</div>
                    <div class="col-md-6">{{aSensor.SERIAL_NUMBER || '---'}}</div>
                </div>
                <!-- Housing Serial Number: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Housing Serial Number:</div>
                    <div class="col-md-6">{{aSensor.HOUSING_SERIAL_NUMBER || '---'}}</div>
                </div>
                <!-- Housing Types: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Housing Types:</div>
                    <div class="col-md-6">{{aSensor.Housing_Type || '---'}}</div>
                </div>
                <!--Tapedowns-->
                <div ng-show="DEPtapeDownTable.length > 0">
                    <div class="col-md-3 col-md-offset-1">Tapedowns:</div>
                    <div class="col-md-8">
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <td>Datum Location</td>
                                    <td>Elevation</td>
                                    <td class="col-md-1" style="text-align:center">Offset Correction</td>
                                    <td class="col-md-1" style="text-align:center">Water Surface</td>
                                    <td class="col-md-1" style="text-align:center">Ground Surface</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="dt in DEPtapeDownTable">
                                    <td>{{dt.OP_NAME}}</td>
                                    <td>{{dt.elevation}} {{dt.Vdatum}}</td>
                                    <td style="text-align:center">{{dt.OFFSET_CORRECTION}}</td>
                                    <td style="text-align:center">{{dt.WATER_SURFACE}}</td>
                                    <td style="text-align:center">{{dt.GROUND_SURFACE}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <div class="col-md-3 col-md-offset-1">Sensor Elevation:</div>
                        <div class="col-md-6">{{depSensStatus.SENSOR_ELEVATION || '---'}}</div>
                    </div>
                    <div>
                        <div class="col-md-3 col-md-offset-1">Water Surface Elevation:</div>
                        <div class="col-md-6">{{depSensStatus.WS_ELEVATION || '---'}}</div>
                    </div>
                    <div>
                        <div class="col-md-3 col-md-offset-1">Ground Elevation:</div>
                        <div class="col-md-6">{{depSensStatus.GS_ELEVATION || '---'}}</div>
                    </div>
                    <div>
                        <div class="col-md-3 col-md-offset-1">In feet above:</div>
                        <div class="col-md-6">{{depSensStatus.VDatum || '---'}}</div>
                    </div>

                </div>
                <br clear="all" />
                <!-- Vented (only if Sensor Type is Pressure Transducer)-->
                <div ng-show="aSensor.SENSOR_TYPE_ID == 1">
                    <div>
                        <div class="col-md-3 col-md-offset-1">Vented:</div>
                        <div class="col-md-6">{{aSensor.VENTED ||  '---'}}</div>
                    </div>
                </div>
                <!-- Deployment Type: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Deployment Type:</div>
                    <div class="col-md-6">{{aSensor.Deployment_Type || '---'}}</div>
                </div>
                <!-- Location Description: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Location Description:</div>
                    <div class="col-md-6">{{aSensor.LOCATION_DESCRIPTION || '---'}}</div>
                </div>
                <!-- Interval: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Interval:</div>
                    <div class="col-md-6">{{aSensor.INTERVAL || '---'}} <span ng-show='aSensor.INTERVAL'>seconds</span></div>
                </div>
                <!-- Deploy Date: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Deploy Date and Time:</div>
                    <div class="col-md-6">{{depSensStatus.TIME_STAMP | date: 'MM/dd/yyyy hh:mm a' }} {{depSensStatus.TIME_ZONE}}</div>
                </div>
                <!-- Note: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Note:</div>
                    <div class="col-md-6">{{depSensStatus.NOTES || '---'}}</div>
                </div>
                <!-- Deploy Member: -->
                <div>
                    <div class="col-md-3 col-md-offset-1">Deploy Member:</div>
                    <div class="col-md-6">{{Deployer.FNAME}} {{Deployer.LNAME}}</div>
                </div>
                <br clear="all" />
                <hr />
                <label>Retrieval Information</label>
                <!-- Status Type:* -->
                <div class="form-group required" ng-class="{'has-error':SensorFormR.STATUS_TYPE_ID.$invalid && SensorFormR.STATUS_TYPE_ID.$dirty}">
                    <label class="col-md-3 control-label req" for="STATUS_TYPE_ID">Status:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="STATUS_TYPE_ID" ng-model="aRetrieval.STATUS_TYPE_ID"
                                ng-options="s.STATUS_TYPE_ID as s.STATUS for s in statusTypeList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Collection Condition:* -->
                <div class="form-group required" ng-class="{'has-error':SensorFormR.INST_COLLECTION_ID.$invalid && SensorFormR.INST_COLLECTION_ID.$dirty}">
                    <label class="col-md-3 control-label req" for="INST_COLLECTION_ID">Collection Conditions:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="INST_COLLECTION_ID" ng-model="aSensor.INST_COLLECTION_ID"
                                ng-options="ins.ID as ins.CONDITION for ins in collectCondList" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Note: -->
                <div class="form-group">
                    <label class="col-md-3 control-label" for="NOTES">Note:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" name="NOTES" type="text" rows="3" ng-model="aRetrieval.NOTES" elastic />
                    </div>
                </div>


                <!-- Retrieve Time: * -->
                <div class="form-group required" ng-class="{'has-error':SensorFormR.TIME_STAMP.$invalid && SensorFormR.TIME_STAMP.$dirty}">
                    <label class="col-md-3 control-label req" style="margin-top:3%" for="TIME_STAMP">Date and Time:</label>
                    <div class="col-md-6">
                        <datetimepicker hour-step="1" minute-step="1" ng-model="aRetrieval.TIME_STAMP" show-meridian="true" id="retrievalDate"
                                        date-format="MM/dd/yyyy" readonly-date="false" readonly-time="false" date-options="dateOptions"
                                        hidden-time="false" hidden-date="false" show-spinners="true" ng-change="date_change(aRetrieval.TIME_STAMP)">
                        </datetimepicker>
                    </div>
                </div>

                <!-- Time Zone:* -->
                <div class="form-group required">
                    <label class="col-md-3 control-label" for="TIME_ZONE">Time Zone:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="TIME_ZONE" ng-model="aRetrieval.TIME_ZONE"
                                ng-options="vcm for vcm in timeZoneList">
                            <option value=""></option>
                        </select>
                    </div>
                    <button type="button" class="borderLess" tooltip-placement="right" tooltip-append-to-body="true" uib-tooltip="Date/Time will be stored in UTC.">
                        <span class="glyphicon glyphicon-question-sign"></span>
                    </button>
                </div>

                <!-- -------------------------- START TAPEDOWN SECTION --------------------------------  -->
                <!--Add Tapedown button-->
                <div ng-if="OPsPresent" class="form-group">
                    <label class="col-md-3 control-label" for="TAPEDOWNBTN">Tape Down:</label>
                    <div class="col-md-6">
                        <button type="button" ng-click="showTapedownPart()" class="btn btn-primary">Show/Hide Tape Down Information</button>
                    </div>
                </div>
                <div ng-if="!OPsPresent" class="form-group">
                    <label class="col-md-3 control-label" for="TAPEDOWNBTN">Tape Down:</label>
                    <div class="col-md-6">
                        <span>No Datum Locations added to this site for tapedown</span>
                    </div>
                </div>
                <!--start add tapedown area -->
                <div ng-if="addTapedown">
                    <hr />
                    <div class="form-group">
                        <label class="col-md-3 control-label">Datum Location(s):</label>
                        <div class="col-md-6">
                            <div isteven-multi-select
                                 input-model="OPsForTapeDown"
                                 output-model="OPMeasure"
                                 button-label="NAME"
                                 item-label="NAME"
                                 on-item-click="OPchosen(data)"
                                 tick-property="selected"
                                 helper-elements="filter">

                            </div>
                        </div>
                    </div>

                    <br clear="all" />
                    <div ng-show="tapeDownTable.length > 0">
                        <div class="pull-right col-md-6"><em>Note: these are not used for any calculations but are to facilitate field activities</em></div>
                        <table class="table table-condensed">
                            <thead>
                                <tr>
                                    <th>Datum Location</th>
                                    <th>Elevation</th>
                                    <th class="col-md-2">Offset Correction</th>
                                    <th class="col-md-2">Water Surface</th>
                                    <th class="col-md-2">Ground Surface</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="t in tapeDownTable">
                                    <td>{{t.OP_NAME}}<input type="hidden" ng-model="t.OBJECTIVE_TYPE_ID" /><input type="hidden" ng-model="t.OP_MEASUREMENTS_ID" /></td>
                                    <td>
                                        {{t.elevation}} {{t.Vdatum}}
                                    </td>
                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="t.OFFSET_CORRECTION" /></td>
                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="t.WATER_SURFACE" /></td>
                                    <td><input class="form-control" ng-keypress="isnum($event)" ng-model="t.GROUND_SURFACE" /></td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Sensor status fields for tapedown -->
                        <div class="col-md-6">
                            <div class="form-group" style="margin-bottom:0">
                                <label class="col-md-6 control-label" for="SENSOR_ELEVATION">Sensor Elevation:</label>
                                <div class="col-md-6">
                                    <input class="form-control" ng-keypress="isNum($event)" name="SENSOR_ELEVATION" ng-model="aRetrieval.SENSOR_ELEVATION" type="text" />
                                </div>
                            </div>

                            <div class="form-group" style="margin-bottom:0">
                                <label class="col-md-6 control-label" for="WS_ELEVATION">Water Surface Elevation:</label>
                                <div class="col-md-6">
                                    <input class="form-control" ng-keypress="isNum($event)" name="WS_ELEVATION" ng-model="aRetrieval.WS_ELEVATION" type="text" />
                                </div>
                            </div>

                            <div class="form-group" style="margin-bottom:0">
                                <label class="col-md-6 control-label" for="GS_ELEVATION">Ground Elevation:</label>
                                <div class="col-md-6">
                                    <input class="form-control" ng-keypress="isNum($event)" name="GS_ELEVATION" ng-model="aRetrieval.GS_ELEVATION" type="text" />
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-md-6 control-label req" for="VDATUM_ID">In feet above:</label>
                                <div class="col-md-6">
                                    <select class="form-control" id="VDATUM_ID" name="VDATUM_ID" ng-model="aRetrieval.VDATUM_ID"
                                            ng-options="vd.DATUM_ID as vd.DATUM_ABBREVIATION for vd in vertDatumList">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                            <div class="pull-left col-md-12"><em>Note: these elevations are used in the sensor processing and the final products</em></div>
                        </div>
                        <hr />
                    </div>

                    <!-- -------------------------- END TAPEDOWN SECTION --------------------------------  -->

                </div>
                <br clear="all" />

                <!-- Retrieve Member: -->
                <div class="form-group required">
                    <label class="col-md-3 control-label">Retrieve Member:</label>
                    <div class="col-md-6" style="margin-top:12px">{{Retriever.FNAME}} {{Retriever.LNAME}}</div>
                </div>

                <div class="modal-footer">
                    <div class="form-group">
                        <div class="col-md-12">
                            <span>
                                <button ng-if="whichButton == 'Retrieve'" class="btn btn-primary" ng-click="retrieveS(SensorFormR.$valid)">
                                    <span>Submit</span>
                                </button>
                            </span>
                            <span>
                                <button type="button" class="btn btn-warning" ng-click="cancel()">
                                    <span>Cancel</span>
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
        </fieldset>
    </form>
</script>

<!-- MODAL for full Sensor editing (deployed and retrieved states)-->
<script type="text/ng-template" id="fullSensormodal.html">
    <div class="modal-header">
        <h3 class="modal-title">Full Sensor<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>
    <div class="modal-body">
        <!--Deployed Sensor Part-->
        <uib-accordion close-others="false">
            <!--Deployed Sensor Part-->
            <uib-accordion-group is-open="s.depOpen">
                <uib-accordion-heading>
                    <i style="margin-right:10px" class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': s.depOpen, 'glyphicon-chevron-right': !s.depOpen}"></i>
                    <span>Deployed Sensor Information</span>
                </uib-accordion-heading>
                <form name="editableDeployedForm">
                    <fieldset>
                        <!-- Event: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Event:</label>
                            <div class="col-md-6">{{EventName}}</div>
                        </div>

                        <!-- Sensor Type*: -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 req control-label">Sensor Type:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{sensor.Sensor_Type || '---'}}</span>
                                <select ng-show="view.DEPval == 'edit'" class="form-control" name="SENSOR_TYPE_ID" ng-model="depStuffCopy[0].SENSOR_TYPE_ID"
                                        ng-options="s.SENSOR_TYPE_ID as s.SENSOR for s in sensorTypeList" ng-change="getDepTypes(depStuffCopy[0])" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Sensor Brand*: -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 req control-label">Sensor Brand:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{sensor.Sensor_Brand || '---'}}</span>
                                <select ng-show="view.DEPval == 'edit'" class="form-control" name="SENSOR_BRAND_ID" ng-model="depStuffCopy[0].SENSOR_BRAND_ID"
                                        ng-options="sb.SENSOR_BRAND_ID as sb.BRAND_NAME for sb in sensorBrandList" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Serial Number*: -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 req control-label">Serial Number:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval =='detail'">{{sensor.SERIAL_NUMBER || '---'}}</span>
                                <input ng-show="view.DEPval =='edit'" class="form-control" name="SERIAL_NUMBER" ng-model="depStuffCopy[0].SERIAL_NUMBER" type="text" required />
                            </div>
                        </div>

                        <!-- Housing Serial Number: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Housing Serial Number:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{sensor.HOUSING_SERIAL_NUMBER || '---'}}</span>
                                <input ng-show="view.DEPval == 'edit'" class="form-control" name="HOUSING_SERIAL_NUMBER" ng-model="depStuffCopy[0].HOUSING_SERIAL_NUMBER" type="text" />
                            </div>
                        </div>

                        <!-- Housing Types: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Housing Types:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{sensor.Housing_Type || '---'}}</span>
                                <select ng-show="view.DEPval == 'edit'" class="form-control" id="HOUSING_TYPE_ID" name="HOUSING_TYPE_ID" ng-model="depStuffCopy[0].HOUSING_TYPE_ID"
                                        ng-options="ht.HOUSING_TYPE_ID as ht.TYPE_NAME for ht in houseTypeList">
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>
                        <br clear="all" /><hr />
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Tapedowns:</label>
                            <div class="col-md-6">
                                <div ng-show="view.DEPval == 'detail'">
                                    <div ng-show="DEPtapeDownTable.length > 0">
                                        <div class="col-md-8">
                                            <table class="table table-condensed">
                                                <thead>
                                                    <tr>
                                                        <th style="text-align:center">Datum Location</th>
                                                        <th style="text-align:center">Elevation</th>
                                                        <th style="text-align:center">Offset Correction</th>
                                                        <th style="text-align:center">Water Surface</th>
                                                        <th style="text-align:center">Ground Surface</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="dt in DEPtapeDownTable">
                                                        <td>{{dt.OP_NAME}}</td>
                                                        <td style="text-align:center">{{dt.elevation}} {{dt.Vdatum}}</td>
                                                        <td style="text-align:center">{{dt.OFFSET_CORRECTION}}</td>
                                                        <td style="text-align:center">{{dt.WATER_SURFACE}}</td>
                                                        <td style="text-align:center">{{dt.GROUND_SURFACE}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div ng-show="DEPtapeDownTable.length == 0">None chosen</div>
                                </div><!-- detail view -->

                                <div ng-show="view.DEPval == 'edit'">
                                    <!--start add tapedown area -->
                                    <div ng-if="OPsPresent" class="form-group">
                                        <label class="col-md-6 control-label">Datum Locations:</label>
                                        <div class="col-md-6">
                                            <div isteven-multi-select
                                                 input-model="DEPOPsForTapeDown"
                                                 output-model="DEPOPMeasure"
                                                 button-label="NAME"
                                                 item-label="NAME"
                                                 on-item-click="DEPOPchosen(data)"
                                                 tick-property="selected"
                                                 helper-elements="filter">
                                            </div>
                                        </div>
                                    </div>
                                    <div ng-if="!OPsPresent"><span>No Datum Locations added to this site for tapedown</span></div>
                                    <br clear="all" />
                                    <div ng-show="depTapeCopy.length > 0">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th>Datum Location</th>
                                                    <th>Elevation</th>
                                                    <th class="col-sm-2">Offset Correction</th>
                                                    <th class="col-sm-1">Water Surface</th>
                                                    <th class="col-sm-1">Ground Surface</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="t in depTapeCopy">
                                                    <td>{{t.OP_NAME}}<input type="hidden" ng-model="t.OBJECTIVE_TYPE_ID" /><input type="hidden" ng-model="t.OP_MEASUREMENTS_ID" /></td>
                                                    <td>
                                                        {{t.elevation}} {{t.Vdatum}}
                                                    </td>
                                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="t.OFFSET_CORRECTION" /></td>
                                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="t.WATER_SURFACE" /></td>
                                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="t.GROUND_SURFACE" /></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>


                                </div><!-- end if editing -->
                            </div>
                        </div><!--end formgroup for Tapedowns-->
                        <br clear="all" />

                        <!--sensor stat tapedown parts-->
                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Sensor Elevation:</label>
                            <div class="col-md-6">
                                <div ng-show="view.DEPval == 'detail'">
                                    {{DeployedSensorStat.SENSOR_ELEVATION || '--'}}
                                </div>
                                <div ng-show="view.DEPval == 'edit'">
                                    <input class="form-control" ng-keypress="isNum($event)" name="SENSOR_ELEVATION" ng-model="depStuffCopy[1].SENSOR_ELEVATION" type="text" />
                                </div>
                            </div>
                        </div>

                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Water Surface Elevation:</label>
                            <div class="col-md-6">
                                <div ng-show="view.DEPval == 'detail'">
                                    {{DeployedSensorStat.WS_ELEVATION || '--'}}
                                </div>
                                <div ng-show="view.DEPval == 'edit'">
                                    <input class="form-control" ng-keypress="isNum($event)" name="WS_ELEVATION" ng-model="depStuffCopy[1].WS_ELEVATION" type="text" />
                                </div>
                            </div>
                        </div>

                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Ground Elevation:</label>
                            <div class="col-md-6">
                                <div ng-show="view.DEPval == 'detail'">
                                    {{DeployedSensorStat.GS_ELEVATION || '--'}}
                                </div>
                                <div ng-show="view.DEPval == 'edit'">
                                    <input class="form-control" ng-keypress="isNum($event)" name="GS_ELEVATION" ng-model="depStuffCopy[1].GS_ELEVATION" type="text" />
                                </div>
                            </div>
                        </div>

                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">In feet above:</label>
                            <div class="col-md-6">
                                <div ng-show="view.DEPval == 'detail'">
                                    {{DeployedSensorStat.VDatum}}
                                </div>
                                <div ng-show="view.DEPval == 'edit'">
                                    <select class="form-control" id="VDATUM_ID" name="VDATUM_ID" ng-model="depStuffCopy[1].VDATUM_ID"
                                            ng-options="vd.DATUM_ID as vd.DATUM_ABBREVIATION for vd in vertDatumList">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <br clear="all" /><hr />
                        <!-- Vented (only if Sensor Type is Pressure Transducer)-->
                        <div ng-show="sensor.SENSOR_TYPE_ID == 1 || depStuffCopy[0].SENSOR_TYPE_ID == 1">
                            <div class="form-group">
                                <label class="col-md-3 col-md-offset-1 control-label">Vented:</label>
                                <div class="col-md-6">
                                    <span ng-show="view.DEPval == 'detail'">{{sensor.VENTED || '---'}}</span>
                                    <span ng-show="view.DEPval == 'edit'">
                                        <label class="radio-inline">
                                            <input type="radio" name="VENTED" ng-model="depStuffCopy[0].VENTED" value="Yes" />Yes
                                        </label>
                                        <label class="radio-inline">
                                            <input type="radio" name="VENTED" ng-model="depStuffCopy[0].VENTED" value="No" />No
                                        </label>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Deployment Type: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Deployment Type:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{sensor.Deployment_Type || '---'}}</span>
                                <select ng-show="view.DEPval == 'edit'" class="form-control" id="DEPLOYMENT_TYPE_ID" name="DEPLOYMENT_TYPE_ID" ng-model="depStuffCopy[0].DEPLOYMENT_TYPE_ID"
                                        ng-options="dt.DEPLOYMENT_TYPE_ID as dt.METHOD for dt in filteredDeploymentTypes">
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Location Description: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Location Description:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{sensor.LOCATION_DESCRIPTION || '---'}}</span>
                                <textarea ng-show="view.DEPval == 'edit'" class="form-control" id="LOCATION_DESCRIPTION" name="LOCATION_DESCRIPTION" type=" text" rows="3" ng-model="depStuffCopy[0].LOCATION_DESCRIPTION" />
                            </div>
                        </div>

                        <!-- Interval: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Interval:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{sensor.INTERVAL || '---'}} <span ng-if='sensor.INTERVAL'>seconds</span></span>
                                <input ng-show="view.DEPval == 'edit'" class="form-control" ng-keypress="isNum($event)" name="INTERVAL" ng-model="depStuffCopy[0].INTERVAL" type="text" />
                            </div>
                        </div>
                        <div class="form-group" ng-show="view.DEPval == 'edit'">
                            <label class="col-md-3 control-label"></label>
                            <div class="col-md-6 col-md-offset-1">
                                <label class="radio-inline">
                                    <input type="radio" name="intervalType" ng-model="IntervalType.type" value="Minutes" />Minutes
                                </label>
                                <label class="radio-inline">
                                    <input type="radio" name="intervalType" ng-model="IntervalType.type" value="Seconds" />Seconds
                                </label>
                            </div>
                        </div>

                        <!-- Deploy Date*: -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 control-label" ng-class="{topPad: view.DEPval == 'edit'}">Deploy Date:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{DeployedSensorStat.TIME_STAMP | date: 'MM/dd/yyyy hh:mm a'}}</span>
                                <datetimepicker ng-show="view.DEPval == 'edit'" hour-step="1" minute-step="1" ng-model="depStuffCopy[1].TIME_STAMP" show-meridian="true"
                                                date-format="MM/dd/yyyy" readonly-date="false" readonly-time="false" date-options="dateOptions"
                                                hidden-time="false" hidden-date="false" show-spinners="true" required>
                                </datetimepicker>
                            </div>
                        </div>

                        <!-- Deploy timezone*:-->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 req control-label">Time Zone:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{DeployedSensorStat.TIME_ZONE}}</span>

                                <select ng-show="view.DEPval == 'edit'" class="form-control" name="TIME_ZONE" ng-model="depStuffCopy[1].TIME_ZONE"
                                        ng-options="vcm for vcm in timeZoneList" required>
                                    <option value=""></option>
                                </select>
                            </div>
                            <button ng-show="view.DEPval == 'edit'" type="button" class="borderLess pull-left" tooltip-placement="right" tooltip-append-to-body="true" uib-tooltip="Date/Time will be stored in UTC.">
                                <span class="glyphicon glyphicon-question-sign"></span>
                            </button>
                        </div>

                        <!-- Note: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Note:</label>
                            <div class="col-md-6">
                                <span ng-show="view.DEPval == 'detail'">{{DeployedSensorStat.NOTES || '---'}}</span>
                                <textarea ng-show="view.DEPval == 'edit'" class="form-control" name="NOTES" type="text" rows="3" ng-model="depStuffCopy[1].NOTES" />
                            </div>
                        </div>

                        <!-- Deploy Member: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Deploy Member:</label>
                            <div class="col-md-6">{{Deployer.FNAME}} {{Deployer.LNAME}}</div>
                        </div>

                        <div class="form-group">
                            <div class="col-md-12">
                                <span>
                                    <button ng-show="view.DEPval == 'detail'" ng-disabled="view.RETval == 'edit'" type="button" class="btn btn-primary" ng-click="wannaEditDep()">
                                        <span>Edit Deployed Sensor</span>
                                    </button>
                                </span>
                                <span>
                                    <button ng-show="view.DEPval == 'edit'" class="btn btn-primary" ng-click="saveDeployed(editableDeployedForm.$valid)">
                                        <span>Save</span>
                                    </button>
                                </span>
                                <span>
                                    <button ng-show="view.DEPval == 'edit'" type="button" class=" btn btn-primary" ng-click="cancelDepEdit()">
                                        <span>Cancel</span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </uib-accordion-group>

            <!--Retrieved Sensor Part-->
            <uib-accordion-group is-open="s.retOpen">
                <uib-accordion-heading>
                    <i style="margin-right:10px" class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': s.retOpen, 'glyphicon-chevron-right': !s.retOpen}"></i>
                    <span>{{mostRecentStatus}} Sensor Information</span>
                </uib-accordion-heading>
                <form name="editableRetrievedForm">
                    <fieldset>
                        <!-- Status Type:* -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 control-label req">Status:</label>
                            <div class="col-md-6">
                                <span ng-show="view.RETval == 'detail'">{{RetrievedSensorStat.Status || '---'}}</span>
                                <select ng-show="view.RETval == 'edit'" class="form-control" name="STATUS_TYPE_ID" ng-model="retStuffCopy[1].STATUS_TYPE_ID"
                                        ng-options="s.STATUS_TYPE_ID as s.STATUS for s in statusTypeList" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Collection Condition:* -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 control-label req" for="INST_COLLECTION_ID">Collection Conditions:</label>
                            <div class="col-md-6">
                                <span ng-show="view.RETval == 'detail'">{{sensor.Inst_Collection || '---'}}</span>
                                <select ng-show="view.RETval == 'edit'" class="form-control" name="INST_COLLECTION_ID" ng-model="retStuffCopy[0].INST_COLLECTION_ID"
                                        ng-options="ins.ID as ins.CONDITION for ins in collectCondList" required>
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>

                        <!-- Note: -->
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label" for="NOTES">Note:</label>
                            <div class="col-md-6">
                                <span ng-show="view.RETval == 'detail'">{{RetrievedSensorStat.NOTES || '---'}}</span>
                                <textarea ng-show="view.RETval == 'edit'" class="form-control" name="NOTES" type="text" rows="3" ng-model="retStuffCopy[1].NOTES" />
                            </div>
                        </div>


                        <!-- Retrieve Time: * -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 control-label" ng-class="{topPad: view.RETval == 'edit'}">Retrieve Date:</label>
                            <div class="col-md-6">
                                <span ng-show="view.RETval == 'detail'">{{RetrievedSensorStat.TIME_STAMP | date: 'MM/dd/yyyy hh:mm a'}}</span>
                                <datetimepicker ng-show="view.RETval == 'edit'" hour-step="1" minute-step="1" ng-model="retStuffCopy[1].TIME_STAMP" show-meridian="true"
                                                date-format="MM/dd/yyyy" readonly-date="false" readonly-time="false" date-options="dateOptions"
                                                hidden-time="false" hidden-date="false" show-spinners="true" required>
                                </datetimepicker>
                            </div>
                        </div>

                        <!-- Timezone*:-->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 req control-label">Time Zone:</label>
                            <div class="col-md-6">
                                <span ng-show="view.RETval == 'detail'">{{RetrievedSensorStat.TIME_ZONE}}</span>

                                <select ng-show="view.RETval == 'edit'" class="form-control" name="TIME_ZONE" ng-model="retStuffCopy[1].TIME_ZONE"
                                        ng-options="vcm for vcm in timeZoneList" required>
                                    <option value=""></option>
                                </select>
                            </div>
                            <button ng-show="view.RETval == 'edit'" type="button" class="borderLess pull-left" tooltip-placement="right" tooltip-append-to-body="true" uib-tooltip="Date/Time will be stored in UTC.">
                                <span class="glyphicon glyphicon-question-sign"></span>
                            </button>
                        </div>
                        <br clear="all" /><hr />
                        <div class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Tapedowns:</label>
                            <div class="col-md-6">
                                <div ng-show="view.RETval == 'detail'">
                                    <div ng-show="RETtapeDownTable.length > 0">
                                        <div class="col-md-8">
                                            <table class="table table-condensed">
                                                <thead>
                                                    <tr>
                                                        <th style="text-align:center">Datum Location</th>
                                                        <th style="text-align:center">Elevation</th>
                                                        <th style="text-align:center">Offset Correction</th>
                                                        <th style="text-align:center">Water Surface</th>
                                                        <th style="text-align:center">Ground Surface</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="rt in RETtapeDownTable">
                                                        <td>{{rt.OP_NAME}}</td>
                                                        <td style="text-align:center">{{rt.elevation}} {{rt.Vdatum}}</td>
                                                        <td style="text-align:center">{{rt.OFFSET_CORRECTION}}</td>
                                                        <td style="text-align:center">{{rt.WATER_SURFACE}}</td>
                                                        <td style="text-align:center">{{rt.GROUND_SURFACE}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div ng-show="RETtapeDownTable.length == 0">None chosen</div>
                                </div><!-- detail view -->

                                <div ng-show="view.RETval == 'edit'">
                                    <!--start add tapedown area -->
                                    <div ng-if="OPsPresent" class="form-group">
                                        <label class="col-md-6 control-label">Datum Locations:</label>
                                        <div class="col-md-6">
                                            <div isteven-multi-select
                                                 input-model="RETOPsForTapeDown"
                                                 output-model="RETOPMeasure"
                                                 button-label="NAME"
                                                 item-label="NAME"
                                                 on-item-click="RETOPchosen(data)"
                                                 tick-property="selected"
                                                 helper-elements="filter">
                                            </div>
                                        </div>
                                    </div>
                                    <div ng-if="!OPsPresent"><span>No Datum Locations added to this site for tapedown</span></div>
                                    <br clear="all" />
                                    <div ng-show="retTapeCopy.length > 0">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th>Datum Location</th>
                                                    <th>Elevation</th>
                                                    <th class="col-sm-2">Offset Correction</th>
                                                    <th class="col-sm-1">Water Surface</th>
                                                    <th class="col-sm-1">Ground Surface</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="rt in retTapeCopy">
                                                    <td>{{rt.OP_NAME}}<input type="hidden" ng-model="rt.OBJECTIVE_TYPE_ID" /><input type="hidden" ng-model="rt.OP_MEASUREMENTS_ID" /></td>
                                                    <td>
                                                        {{rt.elevation}} {{t.Vdatum}}
                                                    </td>
                                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="rt.OFFSET_CORRECTION" /></td>
                                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="rt.WATER_SURFACE" /></td>
                                                    <td><input class="form-control" ng-keypress="isNum($event)" ng-model="rt.GROUND_SURFACE" /></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                </div><!-- end if editing -->
                            </div>
                        </div><!--end formgroup -->
                        <br clear="all" />
                        <!--sensor stat tapedown parts-->
                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Sensor Elevation:</label>
                            <div class="col-md-6">
                                <div ng-show="view.RETval == 'detail'">
                                    {{RetrievedSensorStat.SENSOR_ELEVATION || '--'}}
                                </div>
                                <div ng-show="view.RETval == 'edit'">
                                    <input class="form-control" ng-keypress="isNum($event)" name="SENSOR_ELEVATION" ng-model="retStuffCopy[1].SENSOR_ELEVATION" type="text" />
                                </div>
                            </div>
                        </div>

                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Water Surface Elevation:</label>
                            <div class="col-md-6">
                                <div ng-show="view.RETval == 'detail'">
                                    {{RetrievedSensorStat.WS_ELEVATION || '--'}}
                                </div>
                                <div ng-show="view.RETval == 'edit'">
                                    <input class="form-control" ng-keypress="isNum($event)" name="WS_ELEVATION" ng-model="retStuffCopy[1].WS_ELEVATION" type="text" />
                                </div>
                            </div>
                        </div>

                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">Ground Elevation:</label>
                            <div class="col-md-6">
                                <div ng-show="view.RETval == 'detail'">
                                    {{RetrievedSensorStat.GS_ELEVATION || '--'}}
                                </div>
                                <div ng-show="view.RETval == 'edit'">
                                    <input class="form-control" ng-keypress="isNum($event)" name="GS_ELEVATION" ng-model="retStuffCopy[1].GS_ELEVATION" type="text" />
                                </div>
                            </div>
                        </div>

                        <div ng-if="OPsPresent" class="form-group">
                            <label class="col-md-3 col-md-offset-1 control-label">In feet above:</label>
                            <div class="col-md-6">
                                <div ng-show="view.RETval == 'detail'">
                                    {{RetrievedSensorStat.VDatum}}
                                </div>
                                <div ng-show="view.RETval == 'edit'">
                                    <select class="form-control" id="VDATUM_ID" name="VDATUM_ID" ng-model="retStuffCopy[1].VDATUM_ID"
                                            ng-options="vd.DATUM_ID as vd.DATUM_ABBREVIATION for vd in vertDatumList">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <br clear="all" /><hr />

                        <!-- Retrieve Member: -->
                        <div class="form-group required">
                            <label class="col-md-3 col-md-offset-1 control-label">Member:</label>
                            <div class="col-md-6">{{Retriever.FNAME}} {{Retriever.LNAME}}</div>
                        </div>

                        <div class="form-group">
                            <div class="col-md-12">
                                <span>
                                    <button ng-show="view.RETval == 'detail'" ng-disabled="view.DEPval == 'edit'" type="button" class="btn btn-primary" ng-click="wannaEditRet()">
                                        <span>Edit {{mostRecentStatus}} Sensor</span>
                                    </button>
                                </span>
                                <span>
                                    <button ng-show="view.RETval == 'edit'" class="btn btn-primary" ng-click="saveRetrieved(editableRetrievedForm.$valid)">
                                        <span>Save</span>
                                    </button>
                                </span>
                                <span>
                                    <button ng-show="view.RETval == 'edit'" type="button" class=" btn btn-primary" ng-click="cancelRetEdit()">
                                        <span>Cancel</span>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </uib-accordion-group>

            <!--Sensor File Part-->
            <uib-accordion-group is-open="s.sFileOpen">
                <uib-accordion-heading>
                    <i style="margin-right:10px" class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': s.sFileOpen, 'glyphicon-chevron-right': !s.sFileOpen}"></i>
                    <span>Sensor File Information</span>
                </uib-accordion-heading>
                <div class="col-md-12">
                    <div class="col-md-5"><h4>Sensor Files</h4></div>
                    <div class="col-md-6" ng-if="!showFileForm" style="margin-top:14px">
                        <button type="button" class="borderLess" ng-click="showFile(0)" tooltip-placement="right" uib-tooltip="Upload a new File to this Sensor">
                            <span class="glyphicon glyphicon-plus"></span>
                        </button>
                    </div>
                    <br clear="all" />
                    <!-- list of existing files for this op -->
                    <div class="col-md-6" ng-if="sensorFiles.length > 0">
                        <span ng-repeat="f in sensorFiles">
                            <ul style="padding-left: 0">
                                <li style="list-style:none;padding-bottom: 15px;">
                                    <span class="col-sm-9 borderLess" style="padding:0">
                                        <a class="btn borderLess" style="padding:0" title="{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})" ng-click="showFile(f)">{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})</a>
                                    </span>
                                </li>
                            </ul>
                        </span>
                    </div>
                    <!-- carousel of photo files -->
                    <div class="col-md-6" ng-if="sensImageFiles.length > 0" style="height:120px;">
                        <uib-carousel interval="4000">
                            <uib-slide ng-repeat="f in sensImageFiles">
                                <img ng-click="showImageModal(f.FILE_ID)" ng-src="{{serverURL}}/Files/{{f.FILE_ID}}/Item" />
                                <div class="carousel-caption">
                                    <p>{{f.PATH || f.FILE_URL || f.FILE_ID}}</p>
                                </div>
                            </uib-slide>
                        </uib-carousel>
                    </div>
                    <br clear="all" />

                    <div ng-if="showFileForm">
                        <hr />
                        <form class="form-horizontal" name="DepSenFILEForm">
                            <fieldset>
                                <!--Upload Single Image with validations*-->
                                <div ng-if="aFile.FILE_ID === undefined" class="form-group required" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label" for="FILE">Upload File:</label>
                                    <div class="col-md-8">
                                        <input type="file" max="500000" file-model="aFile.File" />
                                        <img ngf-thumbnail="aFile.File" style="height:60px" class="thumbnail">
                                    </div>
                                </div>
                                <!-- File Type* -->
                                <div class="form-group required" ng-class="{'has-error':DepSenFILEForm.FILETYPE_ID.$invalid && DepSenFILEForm.FILETYPE_ID.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="FILETYPE_ID">File Type:</label>
                                    <div class="col-md-6">
                                        <select class="form-control" name="FILETYPE_ID" ng-model="aFile.FILETYPE_ID"
                                                ng-options="ft.FILETYPE_ID as ft.FILETYPE for ft in fileTypes" required>
                                            <option value=""></option>
                                        </select>
                                    </div>
                                </div>

                                <br clear="all" />

                                <!-- photo file upload fileType==1-->  <!-- all other file upload fileType > 2-->    <!--data file upload fileType==2 -->
                                <!--File URL (Photo, data, other)-->
                                <div ng-if="aFile.FILETYPE_ID > 0" class="form-group" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label" for="FILE_URL">File URL:</label>
                                    <div class="col-md-6">
                                        <input class="form-control" name="FILE_URL" ng-model="aFile.FILE_URL" type="text" />
                                    </div>
                                </div>

                                <!--Data Processed by (Data) -->
                                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label" for="PROCESSOR_ID">Data Process By:</label>
                                    <div class="col-md-6">
                                        <span>{{processor.FNAME}} {{processor.LNAME}}</span>
                                    </div>
                                </div>
                                <!-- Date Collected/Processed* (data)-->
                                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.COLLECT_DATE.$invalid && DepSenFILEForm.COLLECT_DATE.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="COLLECT_DATE">Date Collected/Processed:</label>
                                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                        <input class="form-control" name="dfcd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                               is-open="datepickrs.dfcd" ng-model="datafile.COLLECT_DATE" required />
                                        <span class="input-group-btn">
                                            <button class="btn btn-default" type="button" ng-click="open($event, 'dfcd')">
                                                <i class="glyphicon glyphicon-calendar" />
                                            </button>
                                        </span>
                                    </div>
                                </div>

                                <!--Source Name (photo)-->
                                <div class="form-group required" ng-if="aFile.FILETYPE_ID === 1" ng-class="{'has-error':DepSenFILEForm.FULLNAME.$invalid && DepSenFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="SOURCE_ID">Source Photographer:</label>
                                    <div class="col-md-6">
                                        <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                                    </div>
                                </div>

                                <!--Source Name (all other)-->
                                <div class="form-group required" ng-if="aFile.FILETYPE_ID  > 2" ng-class="{'has-error':DepSenFILEForm.FULLNAME.$invalid && DepSenFILEForm.FULLNAME.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="SOURCE_ID">Source Name:</label>
                                    <div class="col-md-6">
                                        <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                                    </div>
                                </div>

                                <!--Source Agency* (photo, allOther)-->
                                <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID > 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.AGENCY_ID.$invalid && DepSenFILEForm.AGENCY_ID.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="FILETYPE_ID">Source Agency:</label>
                                    <div class="col-md-6">
                                        <select class="form-control" name="AGENCY_ID" ng-model="aSource.AGENCY_ID"
                                                ng-options="a.AGENCY_ID as a.AGENCY_NAME for a in agencies" required>
                                            <option value=""></option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Date Taken* (photo, allother) -->
                                <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID  > 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.SOURCE_DATE.$invalid && DepSenFILEForm.SOURCE_DATE.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="SOURCE_DATE">Date Taken:</label>
                                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                        <input class="form-control" name="sd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                               is-open="datepickrs.sd" ng-model="aSource.SOURCE_DATE" required />
                                        <span class="input-group-btn">
                                            <button class="btn btn-default" type="button" ng-click="open($event, 'sd')">
                                                <i class="glyphicon glyphicon-calendar" />
                                            </button>
                                        </span>
                                    </div>
                                </div>

                                <!-- Date Uploaded* (photo, data, allother) -->
                                <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':DepSenFILEForm.FILE_DATE.$invalid && DepSenFILEForm.FILE_DATE.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="FILE_DATE">Date Uploaded:</label>
                                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                        <input class="form-control" name="fd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                               is-open="datepickrs.fd" ng-model="aFile.FILE_DATE" required />
                                        <span class="input-group-btn">
                                            <button class="btn btn-default" type="button" ng-click="open($event, 'fd')">
                                                <i class="glyphicon glyphicon-calendar" />
                                            </button>
                                        </span>
                                    </div>
                                </div>

                                <!--Description*(photo, data, allother)-->
                                <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':DepSenFILEForm.DESCRIPTION.$invalid && DepSenFILEForm.DESCRIPTION.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="DESCRIPTION">Description:</label>
                                    <div class="col-md-6">
                                        <textarea class="form-control" id="DESCRIPTION" type="text" rows="3" placeholder="Description" ng-model="aFile.DESCRIPTION" required />
                                    </div>
                                </div>

                                <!-- Good Data Start Time* (data) -->
                                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.GOOD_START.$invalid && DepSenFILEForm.GOOD_START.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="GOOD_START" style="margin-top:4%">Good Data Start Time:</label>
                                    <div class="col-md-6">
                                        <datetimepicker ng-model="datafile.GOOD_START" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                                        hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfgs" date-ng-click="open($event, 'dfgs')" required>
                                        </datetimepicker>
                                    </div>
                                </div>

                                <!-- Good Data End Time* (data)-->
                                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':DepSenFILEForm.GOOD_END.$invalid && DepSenFILEForm.GOOD_END.$dirty}" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req" for="GOOD_END" style="margin-top:4%">Good Data End Time:</label>
                                    <div class="col-md-6">
                                        <datetimepicker ng-model="datafile.GOOD_END" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                                        hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfge" date-ng-click="open($event, 'dfge')" required>
                                        </datetimepicker>
                                    </div>
                                </div>

                                <!-- Timezone*: -->
                                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label req">Time Zone:</label>
                                    <div class="col-md-6">
                                        <select class="form-control" name="TIME_ZONE" ng-model="datafile.TIME_ZONE" ng-options="vcm for vcm in timeZoneList" required>
                                            <option value=""></option>
                                        </select>
                                    </div>
                                    <button type="button" class="borderLess pull-left" tooltip-placement="right" tooltip-append-to-body="true" uib-tooltip="Date/Time will be stored in UTC.">
                                        <span class="glyphicon glyphicon-question-sign"></span>
                                    </button>
                                </div>

                                <!-- Elevation -->
                                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label">Elevation:</label>
                                    <div class="col-md-6">
                                        <label class="radio-inline">
                                            <input type="radio" name="ELEVATION_STATUS" ng-model="datafile.ELEVATION_STATUS" value="Final" />Final
                                        </label>
                                        <label class="radio-inline">
                                            <input type="radio" name="ELEVATION_STATUS" ng-model="datafile.ELEVATION_STATUS" value="Arbitrary" />Arbitrary
                                        </label>
                                    </div>
                                </div>
                                <!-- This is where Other ends, rest is for Photo -->
                                <!--Photo Direction (photo)-->
                                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0;padding-top:5px;">
                                    <label class="col-md-4 control-label" for="PHOTO_DIRECTION">Photo Direction:</label>
                                    <div class="col-md-6">
                                        <input class="form-control" id="PHOTO_DIRECTION" name="PHOTO_DIRECTION" ng-model="aFile.PHOTO_DIRECTION" type="text" />
                                    </div>
                                </div>

                                <!-- Photo Latitude (photo)-->
                                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label" for="LATITUDE_DD">Photo Latitude <br /> (if different):</label>
                                    <div class="col-md-6">
                                        <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="aFile.LATITUDE_DD"
                                               type="text" />
                                    </div>
                                </div>

                                <!--Photo Longitude (photo)-->
                                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label" for="LONGITUDE_DD">Photo Longitude <br /> (if different):</label>
                                    <div class="col-md-6">
                                        <input class="form-control" ng-keypress="isNum($event)" id="LONGITUDE_DD" name="LONGITUDE_DD" ng-model="aFile.LONGITUDE_DD"
                                               type="text" />
                                    </div>
                                </div>

                                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label" for="Caption">Preview Caption:</button></label>
                                    <div class="col-md-6">
                                        <span>
                                            Photo of {{aFile.DESCRIPTION || ' (Description HERE) '}} at {{thisSensorSite.SITE_DESCRIPTION}}, {{thisSensorSite.COUNTY}}, {{thisSensorSite.STATE}}, {{aSource.SOURCE_DATE | date: 'MM/dd/yyyy' || ' Date taken HERE '}}. Photograph by {{aSource.FULLNAME || ' Source Name HERE ' }}, {{(agencies | filter :{AGENCY_ID: aSource.AGENCY_ID})[0].AGENCY_NAME || ' Agency HERE '}}.
                                        </span>
                                    </div>
                                </div>

                                <div ng-if="aFile.FILE_ID !== undefined" class="form-group" style="margin:0;padding:0">
                                    <label class="col-md-4 control-label">Associated File:</label>
                                    <div class="col-md-6">
                                        <a target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item">Download File</a>
                                        <img ng-if="aFile.FILETYPE_ID === 1" style="height:80px;" ng-src="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item" />
                                    </div>
                                </div>
                                <div ng-show="!fullSenfileIsUploading">
                                    <button class="btn btn-primary" ng-if="aFile.FILE_ID != undefined" ng-click="saveFile(DepSenFILEForm.$valid)">Save File</button>
                                    <button class="btn btn-danger" ng-if="aFile.FILE_ID != undefined" ng-click="deleteFile()">Delete File</button>
                                    <button class="btn btn-primary" ng-if="aFile.FILE_ID == undefined" ng-click="createFile(DepSenFILEForm.$valid)">Create File</button>
                                    <button class="btn btn-warning" type="button" ng-click="cancelFile()">Cancel File</button>
                                </div>
                                <div ng-show="fullSenfileIsUploading"><img src="images/fileUpload.gif" /></div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </uib-accordion-group>

            <!-- sensor files in nwis link part-->
            <div ng-if="sensorDataNWIS" style="margin-top:5px;">
                <uib-accordion-group is-open="s.NWISFileOpen">
                    <uib-accordion-heading>
                        <i style="margin-right:10px" class="pull-left glyphicon" ng-class="{'glyphicon-chevron-down': s.NWISFileOpen, 'glyphicon-chevron-right': !s.NWISFileOpen}"></i>
                        <span>NWIS Data Connection</span>
                    </uib-accordion-heading>
                    <div class="col-md-12">
                        <div class="col-md-5"><h4>NWIS metadata for sensor</h4></div>
                        <div class="col-md-2" ng-if="!showNWISFileForm" style="margin-top:14px">
                            <button type="button" class="borderLess" ng-click="showNWISFile(0)" tooltip-placement="top" uib-tooltip="Add file metadata to this Sensor">
                                <span class="glyphicon glyphicon-plus"></span>
                            </button>
                        </div>
                        <br clear="all" />
                        <!-- list of existing files for this op -->
                        <div class="col-md-6" ng-if="sensorNWISFiles.length > 0">
                            <span ng-repeat="f in sensorNWISFiles">
                                <ul style="padding-left: 0">
                                    <li style="list-style:none;padding-bottom: 15px;">
                                        <span class="col-sm-9 borderLess" style="padding:0">
                                            <a class="btn borderLess" style="padding:0" title="{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})" ng-click="showNWISFile(f)">{{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})</a>
                                        </span>
                                    </li>
                                </ul>
                            </span>
                        </div>
                        <div ng-if="showNWISFileForm">
                            <hr />
                            <form class="form-horizontal" name="NWISSenFILEForm">
                                <fieldset>
                                    <!-- File Type* -->
                                    <div class="form-group" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label">File Type:</label>
                                        <div class="col-md-6" style="margin-top:14px">
                                            <span>{{NWISFile.FileType}}</span>
                                        </div>
                                    </div>

                                    <br clear="all" />

                                    <!--File URL-->
                                    <div class="form-group" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label" for="FILE_URL">File URL:</label>
                                        <div class="col-md-6">
                                            <input class="form-control" name="FILE_URL" ng-model="NWISFile.FILE_URL" type="text" />
                                        </div>
                                    </div>

                                    <!--Data Processed by -->
                                    <div class="form-group" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label" for="PROCESSOR_ID">Data Process By:</label>
                                        <div class="col-md-6" style="margin-top:14px">
                                            <span>{{nwisProcessor.FNAME}} {{nwisProcessor.LNAME}}</span>
                                        </div>
                                    </div>
                                    <!-- Date Collected/Processed* (data)-->
                                    <div class="form-group required" ng-class="{'has-error':NWISSenFILEForm.COLLECT_DATE.$invalid && NWISSenFILEForm.COLLECT_DATE.$dirty}" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label req" for="COLLECT_DATE">Date Collected/Processed:</label>
                                        <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                            <input class="form-control" name="dfcd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                                   is-open="datepickrs.dfcd" ng-model="NWISDF.COLLECT_DATE" required />
                                            <span class="input-group-btn">
                                                <button class="btn btn-default" type="button" ng-click="open($event, 'dfcd')">
                                                    <i class="glyphicon glyphicon-calendar" />
                                                </button>
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Date Uploaded* -->
                                    <div class="form-group required" ng-class="{'has-error':NWISSenFILEForm.FILE_DATE.$invalid && NWISSenFILEForm.FILE_DATE.$dirty}" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label req" for="FILE_DATE">Date Uploaded:</label>
                                        <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                                            <input class="form-control" name="fd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                                                   is-open="datepickrs.fd" ng-model="NWISFile.FILE_DATE" required />
                                            <span class="input-group-btn">
                                                <button class="btn btn-default" type="button" ng-click="open($event, 'fd')">
                                                    <i class="glyphicon glyphicon-calendar" />
                                                </button>
                                            </span>
                                        </div>
                                    </div>

                                    <!--Description*-->
                                    <div class="form-group required" ng-class="{'has-error':NWISSenFILEForm.DESCRIPTION.$invalid && NWISSenFILEForm.DESCRIPTION.$dirty}" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label req" for="DESCRIPTION">Description:</label>
                                        <div class="col-md-6">
                                            <textarea class="form-control" id="DESCRIPTION" type="text" rows="3" placeholder="Description" ng-model="NWISFile.DESCRIPTION" required />
                                        </div>
                                    </div>

                                    <!-- Good Data Start Time* (data) -->
                                    <div class="form-group required" ng-class="{'has-error':NWISSenFILEForm.GOOD_START.$invalid && NWISSenFILEForm.GOOD_START.$dirty}" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label req" for="GOOD_START" style="margin-top:4%">Good Data Start Time:</label>
                                        <div class="col-md-6">
                                            <datetimepicker ng-model="NWISDF.GOOD_START" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                                            hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfgs" date-ng-click="open($event, 'dfgs')" required>
                                            </datetimepicker>
                                        </div>
                                    </div>

                                    <!-- Good Data End Time* (data)-->
                                    <div class="form-group required" ng-class="{'has-error':NWISSenFILEForm.GOOD_END.$invalid && NWISSenFILEForm.GOOD_END.$dirty}" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label req" for="GOOD_END" style="margin-top:4%">Good Data End Time:</label>
                                        <div class="col-md-6">
                                            <datetimepicker ng-model="NWISDF.GOOD_END" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                                            hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfge" date-ng-click="open($event, 'dfge')" required>
                                            </datetimepicker>
                                        </div>
                                    </div>

                                    <!-- Timezone*: -->
                                    <div class="form-group required" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label req">Time Zone:</label>
                                        <div class="col-md-6">
                                            <select class="form-control" name="TIME_ZONE" ng-model="NWISDF.TIME_ZONE" ng-options="vcm for vcm in timeZoneList" required>
                                                <option value=""></option>
                                            </select>
                                        </div>
                                        <button type="button" class="borderLess pull-left" tooltip-placement="right" tooltip-append-to-body="true" uib-tooltip="Date/Time will be stored in UTC.">
                                            <span class="glyphicon glyphicon-question-sign"></span>
                                        </button>
                                    </div>

                                    <!-- Elevation -->
                                    <div class="form-group" style="margin:0;padding:0">
                                        <label class="col-md-4 control-label">Elevation:</label>
                                        <div class="col-md-6">
                                            <label class="radio-inline">
                                                <input type="radio" name="ELEVATION_STATUS" ng-model="NWISDF.ELEVATION_STATUS" value="Final" />Final
                                            </label>
                                            <label class="radio-inline">
                                                <input type="radio" name="ELEVATION_STATUS" ng-model="NWISDF.ELEVATION_STATUS" value="Arbitrary" />Arbitrary
                                            </label>
                                        </div>
                                    </div>

                                    <button class="btn btn-primary" ng-if="NWISFile.FILE_ID != undefined" ng-click="saveNWISFile(NWISSenFILEForm.$valid)">Save NWIS File Info</button>
                                    <button class="btn btn-danger" ng-if="NWISFile.FILE_ID != undefined" ng-click="deleteNWISFile()">Delete NWIS File Info</button>
                                    <button class="btn btn-primary" ng-if="NWISFile.FILE_ID == undefined" ng-click="createNWISFile(NWISSenFILEForm.$valid)">Create NWIS File Info</button>
                                    <button class="btn btn-warning" type="button" ng-click="cancelNWISFile()">Cancel NWIS File Info</button>
                                </fieldset>
                            </form>
                        </div>
                    </div>
                </uib-accordion-group>
            </div>
        </uib-accordion>
    </div>
    <div class="modal-footer">
        <div class="form-group">
            <div class="col-md-12">
                <span><button class="btn btn-danger" ng-disabled="showFileForm || showNWISFileForm" ng-click="deleteS()"><span>Delete Sensor</span></button></span>
                <span><button type="button" ng-disabled="showFileForm || showNWISFileForm" class="btn btn-warning" ng-click="cancel()"><span>Close</span></button></span>
            </div>
        </div>
    </div>
</script>

<!-- MODAL for FILE-->
<script type="text/ng-template" id="FILEmodal.html">
    <div class="modal-header">
        <h3 class="modal-title">Site File<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>

    <form class="form-horizontal" name="FILEForm">
        <fieldset>
            <div class="modal-body">
                <!--Upload Single Image with validations*-->
                <div ng-if="aFile.FILE_ID === undefined" class="form-group required">
                    <label class="col-md-3 control-label" for="FILE">Upload File:</label>
                    <div class="col-md-9">
                        <input type="file" max="500000" file-model="aFile.File" />
                        <img ngf-thumbnail="aFile.File" style="height:60px" class="thumbnail">
                    </div>
                </div>

                <!--Multiple files
            <div class="button" ngf-select ng-model="files" ngf-multiple="true">Select</div>
                 Drop files: <div ngf-drop ng-model="files" class="drop-box">Drop</div>-->
                <!--File Type*-->
                <div class="form-group required" ng-class="{'has-error':FILEForm.FILETYPE_ID.$invalid && FILEForm.FILETYPE_ID.$dirty}">
                    <label class="col-md-3 control-label req" for="FILETYPE_ID">File Type:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="FILETYPE_ID" ng-model="aFile.FILETYPE_ID"
                                ng-options="ft.FILETYPE_ID as ft.FILETYPE for ft in fileTypes" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <br clear="all" />

                <!-- photo file upload fileType==1-->  <!-- all other file upload fileType > 2-->    <!--data file upload fileType==2 (NOT DEALT WITH IN THIS MODAL -- only in Sensor Modals) -->
                <!--File URL (Photo, data, other)-->
                <div ng-if="aFile.FILETYPE_ID > 0" class="form-group">
                    <label class="col-md-3 control-label" for="FILE_URL">File URL:</label>
                    <div class="col-md-6">
                        <input class="form-control" name="FILE_URL" ng-model="aFile.FILE_URL" type="text" />
                    </div>
                </div>

                <!--Data Processed by (Data)-->
                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group">
                    <label class="col-md-3 control-label" for="PROCESSOR_ID">Data Process By:</label>
                    <div class="col-md-6">
                        {{processor}}
                    </div>
                </div>

                <!-- Date Collected/Processed* (data) -->
                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':FILEForm.COLLECT_DATE.$invalid && FILEForm.COLLECT_DATE.$dirty}">
                    <label class="col-md-3 control-label req" for="COLLECT_DATE">Date Collected/Processed:</label>
                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                        <input class="form-control" name="dfcd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                               is-open="datepickrs.dfcd" ng-model="datafile.COLLECT_DATE" required />
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" ng-click="open($event, 'dfcd')">
                                <i class="glyphicon glyphicon-calendar" />
                            </button>
                        </span>
                    </div>
                </div>

                <!--Source Name (all other)-->
                <div class="form-group required" ng-if="aFile.FILETYPE_ID === 1" ng-class="{'has-error':FILEForm.FULLNAME.$invalid && FILEForm.FULLNAME.$dirty}">
                    <label class="col-md-3 control-label req" for="SOURCE_ID">Source Photographer:</label>
                    <div class="col-md-6">
                        <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                    </div>
                </div>

                <div class="form-group required" ng-if="aFile.FILETYPE_ID  > 2" ng-class="{'has-error':FILEForm.FULLNAME.$invalid && FILEForm.FULLNAME.$dirty}">
                    <label class="col-md-3 control-label req" for="SOURCE_ID">Source Name:</label>
                    <div class="col-md-6">
                        <input class="form-control" name="FULLNAME" ng-model="aSource.FULLNAME" type="text" required />
                    </div>
                </div>

                <!--Source Agency* (photo, allOther)-->
                <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID > 2" class="form-group required" ng-class="{'has-error':FILEForm.AGENCY_ID.$invalid && FILEForm.AGENCY_ID.$dirty}">
                    <label class="col-md-3 control-label req" for="FILETYPE_ID">Source Agency:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="AGENCY_ID" ng-model="aSource.AGENCY_ID"
                                ng-options="a.AGENCY_ID as a.AGENCY_NAME for a in agencies" required>
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Date Taken* (photo, allother) -->
                <div ng-if="aFile.FILETYPE_ID === 1 || aFile.FILETYPE_ID  > 2" class="form-group required" ng-class="{'has-error':FILEForm.SOURCE_DATE.$invalid && FILEForm.SOURCE_DATE.$dirty}">
                    <label class="col-md-3 control-label req" for="SOURCE_DATE">Date Taken:</label>
                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                        <input class="form-control" name="sd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                               is-open="datepickrs.sd" ng-model="aSource.SOURCE_DATE" required />
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" ng-click="open($event, 'sd')">
                                <i class="glyphicon glyphicon-calendar" />
                            </button>
                        </span>
                    </div>
                </div>

                <!-- Date Uploaded* (photo, data, allother) -->
                <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':FILEForm.FILE_DATE.$invalid && FILEForm.FILE_DATE.$dirty}">
                    <label class="col-md-3 control-label req" for="FILE_DATE">Date Uploaded:</label>
                    <div class="col-md-3 input-group" style="padding-right:14px;padding-left:14px">
                        <input class="form-control" name="fd" type="text" uib-datepicker-popup="MMM dd, yyyy" disabled="disabled" show-weeks="false"
                               is-open="datepickrs.fd" ng-model="aFile.FILE_DATE" required />
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" ng-click="open($event, 'fd')">
                                <i class="glyphicon glyphicon-calendar" />
                            </button>
                        </span>
                    </div>
                </div>

                <!--Description*(photo, data, allother)-->
                <div ng-if="aFile.FILETYPE_ID > 0" class="form-group required" ng-class="{'has-error':FILEForm.DESCRIPTION.$invalid && FILEForm.DESCRIPTION.$dirty}">
                    <label class="col-md-3 control-label req" for="DESCRIPTION">Description:</label>
                    <div class="col-md-6">
                        <textarea class="form-control" id="DESCRIPTION" type="text" rows="3" placeholder="Description" ng-model="aFile.DESCRIPTION" required />
                    </div>
                </div>

                <!-- Good Data Start Time* (data) -->
                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':FILEForm.GOOD_START.$invalid && FILEForm.GOOD_START.$dirty}">
                    <label class="col-md-3 control-label req" for="GOOD_START">Good Data Start Time:</label>
                    <div class="col-md-6">
                        <datetimepicker ng-model="datafile.GOOD_START" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                        hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfgs" date-ng-click="open($event, 'dfgs')" required>
                        </datetimepicker>
                    </div>
                </div>

                <!-- Good Data End Time* (data) -->
                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required" ng-class="{'has-error':FILEForm.GOOD_END.$invalid && FILEForm.GOOD_END.$dirty}">
                    <label class="col-md-3 control-label req" for="GOOD_END">Good Data End Time:</label>
                    <div class="col-md-6">
                        <datetimepicker ng-model="datafile.GOOD_END" show-meridian="true" date-format="MM/dd/yyyy" readonly-date="false" date-options="dateOptions"
                                        hidden-time="false" hidden-date="false" show-spinners="true" date-opened="datepickrs.dfge" date-ng-click="open($event, 'dfge')" required>
                        </datetimepicker>
                    </div>
                </div>

                <!-- Timezone*:-->
                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group required">
                    <label class="col-md-3 control-label req">Time Zone:</label>
                    <div class="col-md-6">
                        <select class="form-control" name="TIME_ZONE" ng-model="datafile.TIME_ZONE" ng-options="vcm for vcm in timeZoneList" required>
                            <option value=""></option>
                        </select>
                    </div>
                    <button type="button" class="borderLess pull-left" tooltip-placement="right" tooltip-append-to-body="true" uib-tooltip="Date/Time will be stored in UTC.">
                        <span class="glyphicon glyphicon-question-sign"></span>
                    </button>
                </div>

                <div ng-if="aFile.FILETYPE_ID === 2" class="form-group">
                    <label class="col-md-3 control-label">Elevation:</label>
                    <div class="col-md-6">
                        <label class="radio-inline">
                            <input type="radio" name="ELEVATION_STATUS" ng-model="datafile.ELEVATION_STATUS" value="Final" />Final
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="ELEVATION_STATUS" ng-model="datafile.ELEVATION_STATUS" value="Arbitrary" />Arbitrary
                        </label>
                    </div>
                </div>

                <!-- This is where Other ends, rest is for Photo -->
                <!--Photo Direction (photo)-->
                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group">
                    <label class="col-md-3 control-label" for="PHOTO_DIRECTION">Photo Direction:</label>
                    <div class="col-md-6">
                        <input class="form-control" id="PHOTO_DIRECTION" name="PHOTO_DIRECTION" ng-model="aFile.PHOTO_DIRECTION" type="text" />
                    </div>
                </div>

                <!-- Photo Latitude (photo)-->
                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group">
                    <label class="col-md-3 control-label" for="LATITUDE_DD">Photo Latitude <br /> (if different):</label>
                    <div class="col-md-6">
                        <input class="form-control" ng-keypress="isNum($event)" name="LATITUDE_DD" id="LATITUDE_DD" ng-model="aFile.LATITUDE_DD"
                               type="text" />
                    </div>
                </div>

                <!--Photo Longitude (photo)-->
                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group">
                    <label class="col-md-3 control-label" for="LONGITUDE_DD">Photo Longitude <br /> (if different):</label>
                    <div class="col-md-6">
                        <input class="form-control" ng-keypress="isNum($event)" id="LONGITUDE_DD" name="LONGITUDE_DD" ng-model="aFile.LONGITUDE_DD"
                               type="text" />
                    </div>
                </div>

                <div ng-if="aFile.FILETYPE_ID === 1" class="form-group">
                    <label class="col-md-3 control-label" for="Caption">Preview Caption:</button></label>
                    <div class="col-md-6">
                        <span>
                            Photo of {{aFile.DESCRIPTION || ' (Description HERE) '}} at {{theSite.SITE_DESCRIPTION}}, {{theSite.COUNTY}}, {{theSite.STATE}}, {{aSource.SOURCE_DATE | date: 'MM/dd/yyyy' || ' Date taken HERE '}}. Photograph by {{aSource.FULLNAME || ' Source Name HERE ' }}, {{(agencies | filter :{AGENCY_ID: aSource.AGENCY_ID})[0].AGENCY_NAME || ' Agency HERE '}}.
                        </span>
                    </div>
                </div>

                <div ng-if="aFile.FILE_ID !== undefined" class="form-group">
                    <label class="col-md-3 control-label">Associated File:</label>
                    <div class="col-md-6">
                        <a target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item">Download File</a>
                        <img ng-if="aFile.FILETYPE_ID === 1" style="height:80px;" ng-src="{{serverURL}}/Files/{{aFile.FILE_ID}}/Item" />
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <div ng-show="!sFileIsUploading">
                    <button class="btn btn-primary" ng-if="aFile.FILE_ID != undefined" ng-click="save(FILEForm.$valid)">Save</button>
                    <button class="btn btn-danger" ng-if="aFile.FILE_ID != undefined" ng-click="deleteFile()">Delete</button>
                    <button class="btn btn-primary" ng-if="aFile.FILE_ID == undefined" ng-click="create(FILEForm.$valid)">Create</button>
                    <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>
                </div>
                <div ng-show="sFileIsUploading"><img src="images/fileUpload.gif" /></div>
            </div>
        </fieldset>
    </form>
</script>
<style type="text/css">
    .needRetrieve {
        color: red;
    }


    .chart div {
        width: 0;
        transition: all 1s ease-out;
        -moz-transition: all 1s ease-out;
        -webkit-transition: all 1s ease-out;
        font: 10px sans-serif;
        background-color: steelblue;
        text-align: right;
        padding: 3px;
        margin: 5px;
        color: white;
        box-shadow: 2px 2px 2px #666;
    }
</style>
<!-- MODAL for PEAK Create/edit-->
<script type="text/ng-template" id="PEAKmodal.html">
    <div class="modal-header">
        <h3 class="modal-title">Peak Summary<button class="close" type="button" ng-click="cancel()" aria-hidden="true" style="color:gray;">&times;</button></h3>
    </div>
    <form class="form-horizontal" name="peakForm" role="form">
        <fieldset>
            <div class="modal-body">
                <!-- Start SENSORs and HWMs used for Peak -->
                <label class="col-md-4 text-center">Select Data used for Interpretation</label>
                <!-- HWM list-->
                <div class="col-md-9" ng-repeat="h in eventSiteHWMs">
                    <input type="checkbox" class="col-sm-1 pull-left" ng-model="h.selected" ng-click="addHWM(h)" />
                    <span class="col-md-7">
                        HWM {{h.HWM_ID}} - {{h.ELEV_FT || '--'}} ft
                    </span>
                    <button type="button" class="borderLess" tooltip-placement="top" uib-tooltip="Show Details" ng-click="showHWMDetails(h)"><span class="glyphicon glyphicon-info-sign"></span></button>
                    <button type="button" class="borderLess" tooltip-placement="top" uib-tooltip="Set as Primary" ng-click="primaryHWM(h)"><span class="glyphicon glyphicon-check"></span></button>
                </div>
                <!-- Sensor list -->
                <div class="col-md-9" ng-repeat="s in eventSiteSensors">
                    <span class="col-sm-1"> </span>
                    <span class="col-md-7">
                        {{s.Instrument.Deployment_Type || s.Instrument.Sensor_Type}} Sensor
                    </span>
                    <button type="button" class="borderLess" tooltip-placement="top" uib-tooltip="Show Details" ng-click="showSensorDetails(s)"><span class="glyphicon glyphicon-info-sign"></span></button>
                    <button ng-if="s.NeedDF" type="button" class="borderLess" tooltip-placement="top" uib-tooltip="Incomplete" ng-click="showIncompleteInfo()"><span class="glyphicon glyphicon-alert"></span></button>
                    <button ng-if="!s.isRetrieved" type="button" class="borderLess" tooltip-placement="top" uib-tooltip="Needs to be Retrieved" ng-click="showRetrieveInfo()"><span class="needRetrieve glyphicon glyphicon-alert"></span></button>
                    <div ng-repeat="f in s.files | where:{FILETYPE_ID: 2}">
                        <span class="col-sm-1"> </span>
                        <input type="checkbox" class="pull-left col-sm-1" ng-model="f.selected" ng-click="addDataFile(f)" />
                        <span class="col-md-6">{{f.PATH}}</span>
                        <button type="button" class="borderLess" tooltip-placement="top" uib-tooltip="Show Details" ng-click="showDataFileDetails(f)"><span class="glyphicon glyphicon-info-sign"></span></button>
                        <button type="button" class="borderLess" tooltip-placement="top" uib-tooltip="Set as Primary" ng-click="primaryDataFile(f)"><span class="glyphicon glyphicon-check"></span></button>
                    </div>
                </div>

                <br clear="all" />

                <!-- hwm box of meta data and files -->
                <div style="border:solid 1px black;padding-bottom:10px;" class="container col-md-12" ng-if="hwmDetail">
                    <!-- only show if they click showHWMDetails() above -->
                    <label>HWM {{HWMBox.HWM_ID}} Details</label><button class="close" type="button" ng-click="closeDetail()" aria-hidden="true" style="color:gray;">&times;</button>
                    <ul>
                        <li style="list-style:none">Location Description: {{HWMBox.HWM_LOCATION_DESCRIPTION || '--'}}</li>
                        <li style="list-style:none">Bank: {{HWMBox.BANK}}</li>
                        <li style="list-style:none">Flag Date: {{HWMBox.FLAG_DATE | date:'MM/dd/yyyy'}}</li>
                        <li style="list-style:none">Elevation: {{HWMBox.ELEV_FT}} ft</li>
                        <li style="list-style:none">Elevation above ground: {{HWMBox.HEIGHT_ABV_GND}} ft</li>
                        <li style="list-style:none">Quality: {{HWMBox.HWM_QUALITY}}</li>
                        <li style="list-style:none">Type: {{HWMBox.HWM_TYPE}}</li>
                        <li style="list-style:none">Stillwater: {{HWMBox.STILLWATER}}</li>
                    </ul><br clear="all" />
                    <div class="col-md-12" ng-if="HWMBox.files.length > 0">
                        <label>HWM Files</label>
                        <span ng-repeat="f in HWMBox.files">
                            <ul style="padding-left: 0">
                                <li style="list-style:none;padding-bottom: 15px;">
                                    <span class="col-sm-9 borderLess" style="padding:0">
                                        <a class="btn borderLess" style="padding:0" target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{f.FILE_ID}}/Item">
                                            {{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})
                                        </a>
                                    </span>
                                </li>
                            </ul>
                        </span>
                    </div>
                    <!-- carousel of photo files -->
                    <div class="col-md-6" ng-if="HWMBox.files.length > 0" style="height:120px;">
                        <uib-carousel interval="4000">
                            <uib-slide ng-repeat="f in HWMBox.files | where:{FILETYPE_ID:1}">
                                <img ng-click="showImageModal(f.FILE_ID)" ng-src="{{serverURL}}/Files/{{f.FILE_ID}}/Item" />
                                <div class="carousel-caption">
                                    <p>{{f.PATH || f.FILE_URL || f.FILE_ID}}</p>
                                </div>
                            </uib-slide>
                        </uib-carousel>
                    </div>
                </div>
                <!-- sensor box of meta data and files -->
                <div style="border:solid 1px black;padding-bottom:10px" class="container col-md-12" ng-if="sensorDetail">
                    <!-- only show if they click showSensorDetails() above -->
                    <label>{{SensorBox.Instrument.Deployment_Type || SensorBox.Instrument.Sensor_Type}} Sensor Details</label><button class="close" type="button" ng-click="closeDetail()" aria-hidden="true" style="color:gray;">&times;</button>
                    <ul>
                        <li style="list-style:none">Sensor Type: {{SensorBox.Instrument.Sensor_Type}}</li>
                        <li style="list-style:none">Deployment Type: {{SensorBox.Instrument.Deployment_Type || '--'}}</li>
                        <li style="list-style:none">Retrieved on: {{SensorBox.InstrumentStats[0].TIME_STAMP | date: 'MM/dd/yyyy hh:mm a'}}</li>
                        <li style="list-style:none">Collection Condition: {{SensorBox.CollectCondition || '--'}}</li>
                        <li style="list-style:none">Serial Number: {{SensorBox.Instrument.SERIAL_NUMBER || '--'}}</li>
                        <li style="list-style:none">Location Description: {{SensorBox.Instrument.LOCATION_DESCRIPTION || '--'}}</li>
                        <li style="list-style:none">Sensor Brand: {{SensorBox.Instrument.Sensor_Brand || '--'}}</li>
                    </ul><br clear="all" />
                    <div class="col-md-12">
                        <label>Sensor Files</label>
                        <div ng-if="SensorBox.files.length > 0">
                            <span ng-repeat="f in SensorBox.files">
                                <ul style="padding-left: 0">
                                    <li style="list-style:none;padding-bottom: 15px;">
                                        <span class="col-sm-9 borderLess" style="padding:0">
                                            <a class="btn borderLess" style="padding:0" target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{f.FILE_ID}}/Item">
                                                {{f.FILE_DATE | date: 'MM/dd/yyyy'}} ({{f.PATH || f.FILE_URL || f.FILE_ID}})
                                            </a>
                                        </span>
                                    </li>
                                </ul>
                            </span>
                        </div>
                        <div ng-if="SensorBox.files.length == 0">
                            <span>No files</span>
                        </div>
                        <!-- carousel of photo files-->
                        <div class="col-md-6" ng-if="SensorBox.files.length > 0" style="height:120px;">
                            <uib-carousel interval="4000">
                                <uib-slide ng-repeat="f in SensorBox.files | where:{FILETYPE_ID:1}">
                                    <img ng-click="showImageModal(f.FILE_ID)" ng-src="{{serverURL}}/Files/{{f.FILE_ID}}/Item" />
                                    <div class="carousel-caption">
                                        <p>{{f.PATH || f.FILE_URL || f.FILE_ID}}</p>
                                    </div>
                                </uib-slide>
                            </uib-carousel>
                        </div>
                    </div>

                </div>
                <!-- datafile box of meta data and datafiles -->
                <div style="border:solid 1px black;padding-bottom:10px" class="container col-md-12" ng-if="dataFileDetail">
                    <!-- only show if they click showDataFileDetails() above -->
                    <label>Data File {{DFBox.filePath}} Details</label><button class="close" type="button" ng-click="closeDetail()" aria-hidden="true" style="color:gray;">&times;</button>
                    <ul>
                        <li style="list-style:none">Description: {{DFBox.fileDesc || '--'}}</li>
                        <li style="list-style:none">Collected on: {{DFBox.COLLECT_DATE | date: 'MM/dd/yyyy hh:mm a'}} UTC</li>
                        <li style="list-style:none">Good Start: {{DFBox.GOOD_START | date: 'MM/dd/yyyy hh:mm a'}} UTC</li>
                        <li style="list-style:none">Good End:{{DFBox.GOOD_END | date: 'MM/dd/yyyy hh:mm a'}} UTC</li>
                        <li style="list-style:none">Processed By: {{DFBox.processedBy.FNAME}} {{DFBox.processedBy.LNAME}}</li>
                        <li style="list-style:none">Elevation Status: {{DFBox.ELEVATION_STATUS}}</li>
                    </ul><br clear="all" />
                    <div class="col-md-12">
                        <label>File</label><br clear="all" />
                        <!-- TODO :: IF this is an NWIS file, show link to go see the data instead of the link to download -->
                        <span ng-if="!DFBox.nwisFile" class="col-sm-9 borderLess" style="padding:0">
                            <a class="btn borderLess" style="padding:0" target="_blank" class="btn btn-primary" ng-href="{{serverURL}}/Files/{{DFBox.fileID}}/Item">
                                {{DFBox.COLLECT_DATE | date: 'MM/dd/yyyy'}} ({{DFBox.filePath}})
                            </a>
                        </span>
                        <span ng-if="DFBox.nwisFile" class="col-sm-9 borderLess" style="padding:0">
                            <a class="btn borderLess" style="padding:0" target="_blank" class="btn btn-primary" ng-href="{{DFBox.fileURL}}">{{DFBox.fileURL}}</a>
                        </span>
                    </div>
                </div>
                <!--</div>
                </div>
                </div>-->
                <!-- End SENSORs and HWMs used for Peak -->


                <br clear="all" />

                <!-- Location Description: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="CALC_NOTES">Peak Calculation Notes:</label>
                    <div class="col-md-5">
                        <textarea class="form-control" name="CALC_NOTES" type=" text" rows="3" placeholder="Please document the reason this Peak was chosen for this event." ng-model="aPeak.CALC_NOTES" />
                    </div>
                </div>
                <br clear="all" />

                <!--Peak creator-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="MEMBER_ID">Peak Creator:</label>
                    <div class="col-md-5" style="margin-top:13px">
                        <span>{{PeakCreator.FNAME}} {{PeakCreator.LNAME}}</span>
                    </div>
                </div>

                <!-- Peak Date: * -->
                <div class="form-group required" ng-class="{'has-error':peakForm.PEAK_DATE.date.$invalid && peakForm.PEAK_DATE.date.$dirty}">
                    <label class="col-md-4 control-label req" for="PEAK_DATE.date">Peak Date:</label>
                    <div class="col-md-5">
                        <datetimepicker hour-step="1" minute-step="1" ng-model="aPeak.PEAK_DATE.date" show-meridian="true"
                                        date-format="MM/dd/yyyy" readonly-date="false" readonly-time="false" date-options="dateOptions"
                                        hidden-time="true" hidden-date="false" show-spinners="true" required>
                        </datetimepicker>
                    </div>
                    <div class="col-md-1">
                        <span tooltip-placement="right" uib-tooltip="Date Estimated?">
                            <input type="checkbox" name="IS_PEAK_ESTIMATED" ng-model="aPeak.IS_PEAK_ESTIMATED" ng-true-value="1" ng-false-value="0" />
                        </span>
                    </div>
                </div>

                <!-- Peak Time: * -->
                <div class="form-group required" ng-class="{'has-error':peakForm.PEAK_DATE.time.$invalid && peakForm.PEAK_DATE.time.$dirty}">
                    <label class="col-md-4 control-label req" style="margin-top:4%" for="PEAK_TIME.time">Peak Time:</label>
                    <div class="col-md-5">
                        <datetimepicker hour-step="1" minute-step="1" ng-model="aPeak.PEAK_DATE.time" show-meridian="true"
                                        date-format="MM/dd/yyyy" readonly-date="false" readonly-time="false" date-options="dateOptions"
                                        hidden-time="false" hidden-date="true" show-spinners="true" required>
                        </datetimepicker>
                    </div>
                    <div class="col-md-1" style="margin-top:4%">
                        <span tooltip-placement="right" uib-tooltip="Time Estimated?">
                            <input type="checkbox" name="IS_PEAK_TIME_ESTIMATED" ng-model="aPeak.IS_PEAK_TIME_ESTIMATED" ng-true-value="1" ng-false-value="0" />
                        </span>
                    </div>
                </div>

                <!-- Time Zone:* -->
                <div class="form-group required">
                    <label class="col-md-4 control-label" for="TIME_ZONE">Peak Recorded In:</label>
                    <div class="col-md-5">
                        <select class="form-control" name="TIME_ZONE" ng-model="aPeak.TIME_ZONE"
                                ng-options="vcm for vcm in timeZoneList" required>
                            <option value=""></option>
                        </select>
                    </div>
                    <button type="button" class="borderLess" tooltip-placement="right" uib-tooltip="Date/Time will be stored in UTC.">
                        <span class="glyphicon glyphicon-question-sign"></span>
                    </button>
                </div>

                <!-- Peak Stage-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="PEAK_STAGE">Peak Stage (elevation ft):</label>
                    <div class="col-md-5">
                        <input class="form-control" ng-keypress="isNum($event)" name="PEAK_STAGE" ng-model="aPeak.PEAK_STAGE" type="text" />
                    </div>
                    <div class="col-md-1">
                        <span tooltip-placement="right" uib-tooltip="Peak Stage Estimated?">
                            <input type="checkbox" name="IS_PEAK_STAGE_ESTIMATED" ng-model="aPeak.IS_PEAK_STAGE_ESTIMATED" ng-true-value="1" ng-false-value="0" />
                        </span>
                    </div>
                </div>

                <!-- Vertical Datum: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="VDATUM_ID">Vertical Datum:</label>
                    <div class="col-md-5">
                        <select class="form-control" name="VDATUM_ID" ng-model="aPeak.VDATUM_ID"
                                ng-options="vd.DATUM_ID as vd.DATUM_ABBREVIATION for vd in VDatumsList">
                            <option value=""></option>
                        </select>
                    </div>
                </div>

                <!-- Height Above Ground (ft)-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="HEIGHT_ABOVE_GND">Height Above Ground <br />(depth of water in ft):</label>
                    <div class="col-md-5">
                        <input class="form-control" ng-keypress="isNum($event)" name="HEIGHT_ABOVE_GND" ng-model="aPeak.HEIGHT_ABOVE_GND" type="text" />
                    </div>
                    <div class="col-md-1">
                        <span tooltip-placement="right" uib-tooltip="HAG Estimated?">
                            <input type="checkbox" name="IS_HAG_ESTIMATED" ng-model="aPeak.IS_HAG_ESTIMATED" ng-true-value="1" ng-false-value="0" />
                        </span>
                    </div>
                </div>

                <!-- Peak Discharge-->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="PEAK_DISCHARGE">Peak Discharge:</label>
                    <div class="col-md-5">
                        <input class="form-control" ng-keypress="isNum($event)" name="PEAK_DISCHARGE" ng-model="aPeak.PEAK_DISCHARGE" type="text" />
                    </div>
                    <div class="col-md-1">
                        <span tooltip-placement="right" uib-tooltip="Peak Discharge Estimated?">
                            <input type="checkbox" name="IS_PEAK_DISCHARGE_ESTIMATED" ng-model="aPeak.IS_PEAK_DISCHARGE_ESTIMATED" ng-true-value="1" ng-false-value="0" />
                        </span>
                    </div>
                </div>

                <!--AEP: -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="AEP">AEP:</label>
                    <div class="col-md-5">
                        <input class="form-control" ng-keypress="isNum($event)" name="AEP" ng-model="aPeak.AEP" type="text" />
                    </div>
                </div>

                <!--AEP Confidence Interval (lower limit): -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="AEP_LOWCI">AEP Confidence Interval<br />(lower limit):</label>
                    <div class="col-md-5">
                        <input class="form-control" ng-keypress="isNum($event)" name="AEP_LOWCI" ng-model="aPeak.AEP_LOWCI" type="text" />
                    </div>
                </div>

                <!--AEP Confidence Interval (upper limit): -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="AEP_UPPERCI">AEP Confidence Interval<br />(upper limit):</label>
                    <div class="col-md-5">
                        <input class="form-control" ng-keypress="isNum($event)" name="AEP_UPPERCI" ng-model="aPeak.AEP_UPPERCI" type="text" />
                    </div>
                </div>

                <!--AEP Confidence Interval (percentage of limits): -->
                <div class="form-group">
                    <label class="col-md-4 control-label" for="AEP_RANGE">AEP Confidence Interval<br />(percentage of limits):</label>
                    <div class="col-md-5">
                        <input class="form-control" ng-keypress="isNum($event)" name="AEP_RANGE" ng-model="aPeak.AEP_RANGE" type="text" />
                    </div>
                </div>



            </div><!-- end modal-body-->
            <div class="modal-footer">
                <button class="btn btn-primary" ng-if="aPeak.PEAK_SUMMARY_ID != undefined" ng-click="savePeak(peakForm.$valid)">Save</button>
                <button class="btn btn-primary" ng-if="aPeak.PEAK_SUMMARY_ID == undefined" ng-click="createPeak(peakForm.$valid)">Create</button>
                <button class="btn btn-danger" ng-if="loggedInRole == 'Admin' && aPeak.PEAK_SUMMARY_ID !== undefined" ng-click="deletePeak()">Delete</button>
                <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>
            </div>
        </fieldset>
    </form>
</script>
